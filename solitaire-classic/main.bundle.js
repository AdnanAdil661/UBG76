(()=>{"use strict";var e,t={2728:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FamobiAPI=void 0;const a=i(s(6756));class n{static addFamobiHandlers(){window.famobi_onPauseRequested=function(){famobi.log("famobi_onPauseRequested"),a.default.instance.pause()},window.famobi_onResumeRequested=function(){famobi.log("famobi_onResumeRequested"),a.default.instance.resume()},window.famobi.onRequest("enableAudio",(function(){a.default.instance.sound.volume=1})),window.famobi.onRequest("disableAudio",(function(){a.default.instance.sound.volume=0})),window.famobi.onRequest("pauseGameplay",(function(){a.default.instance.pause()})),window.famobi.onRequest("resumeGameplay",(function(){a.default.instance.resume()}))}}n.handleLevelEndEvent=function(e,t,s){window.famobi?(a.default.instance.pause(),window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"LEVELEND",result:e,score:t}).then((()=>{a.default.instance.resume(),s()})).catch((()=>{}))):s()},n.lastLiveScoreReportTimestamp=0,n._lastLiveScore=-1,n._sendLiveScore=function(e){n.lastLiveScoreReportTimestamp=(new Date).getTime(),window.famobi_analytics.trackEvent("EVENT_LIVESCORE",{liveScore:e})},n.reportLiveScore=function(e){const t=(new Date).getTime();n.lastLiveScoreReportTimestamp=n.lastLiveScoreReportTimestamp||0,t-n.lastLiveScoreReportTimestamp>=1e3?n._sendLiveScore(e):(n._lastLiveScore=e,n._nextReportTimeout||(n._nextReportTimeout=setTimeout((()=>{void 0!==n._lastLiveScore&&(n._sendLiveScore(n._lastLiveScore),n._lastLiveScore=void 0),n._nextReportTimeout=void 0}),1e3-(t-n.lastLiveScoreReportTimestamp))))},t.FamobiAPI=n},8240:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initFamobiMockObject=void 0;t.initFamobiMockObject=()=>{if("undefined"!=typeof famobi||window.famobi)return;const e=(e,t="#bada55",s="#222")=>console.log("%c "+e,`background: ${s}; color: ${t}`);console.warn("Injecting famobi mock object..."),famobi=window.famobi={},famobi.setPreloadProgress=t=>e(`Progress ${t}%`,"#880000","#FFEEEE"),famobi.localStorage=window.localStorage,famobi.log=(...e)=>console.log(...e),famobi.gameReady=function(){e("'Game ready to start' reported","#FFFFFF","#880000")},famobi.hasRewardedAd=()=>famobi.hasFeature("rewarded")&&!0,famobi.rewardedAd=e=>{console.log("Watching rewarded video..."),setTimeout((()=>{e({rewardGranted:!0})}),1e3)},famobi.getOffsets=()=>({top:0,right:0,bottom:0,left:0}),famobi.onOffsetChange=e=>{},famobi.getCurrentLanguage=()=>"ru",famobi.onRequest=function(t,s){e(`famobi.onRequest(${t})`,"#FFFFDD","#5533FF"),famobi.requests=famobi.requests||{},famobi.requests[t]=s,"startGame"===t&&(console.warn("Starting game in 500 ms..."),setTimeout((()=>s()),500))},famobi.triggerRequest=function(t,...s){e(`famobi->request(${t})`,"#FFFFDD","#5533FF"),famobi.requests&&famobi.requests[t]&&famobi.requests[t](...s)},famobi.getVolume=function(){return.5},famobi.playerReady=function(){e("playerReady() reported","#00FF66","#000")},famobi.hasFeature=function(e){return{trackstats:!1,external_start:!1,skip_title:!1,skip_tutorial:!1,forced_mode:!1,auto_quality:!1,external_mute:!1,copyright:!0,rewarded:!0}[e]||!1},famobi.showInterstitialAd=(e,t)=>{"object"==typeof e?e.callback():t()},famobi.getMoreGamesButtonImage=famobi.getBrandingButtonImage=()=>"https://games.cdn.famobi.com/portal/4638e320-4444-4514-81c4-d80a8c662371/more-games-button/600x253/5a6895c0f28fb.png",famobi.moreGamesLink=famobi.openBrandingLink=()=>e("More games link"),famobi_analytics=window.famobi_analytics={trackEvent:(t,s)=>new Promise(((i,a)=>{e("famobi_analytics.trackEvent("+t+", "+JSON.stringify(s)+")"),"EVENT_LEVELSTART"===t||"EVENT_LEVELRESTART"===t?setTimeout((()=>i()),100):i()})),trackStats:(t,s,i)=>{e("[trackStats] "+t+" x"+(i||1)+" "+JSON.stringify(s||""),"#FFFFFF","#FF00FF")}}}},6756:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(1066),n=i(s(2260));class o extends n.default.Game{static get instance(){return this._instance}constructor(e){super(e),o._instance=this}get currentScene(){return this._currentScene}set currentScene(e){this._currentScene=e}get paused(){return this._paused}pause(){var e;super.pause(),this._paused=!0,null===(e=this.currentScene)||void 0===e||e.events.emit(a.EventTypes.GAME_PAUSED)}resume(){var e;super.resume(),this._paused=!1,null===(e=this.currentScene)||void 0===e||e.events.emit(a.EventTypes.GAME_RESUMED)}}t.default=o},4353:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SoundManager=void 0;const a=i(s(6756));class n{static get instance(){return n._instance?n._instance:n._instance=new n}constructor(){this.globalVolume=1,this.audioReady=!1,this.debouncedSoundsTimestamps=new Map,this.soundNames=["click","card","card_to_base","error","new_game","pick_card","place_card","win"]}getSoundNames(){return this.soundNames}play(e,t=1,s=10){const i=(new Date).getTime();if(i-(this.debouncedSoundsTimestamps.get(e)||0)>=s){try{a.default.instance.currentScene.sound.play(e,{volume:t*this.globalVolume})}catch(e){console.warn("Audio playback error: ",e)}this.debouncedSoundsTimestamps.set(e,i)}}dispatchAudioReady(){this.audioReady=!0}setGlobalVolume(e){this.globalVolume=e}}t.SoundManager=n},3786:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.rewardedVideosEnabled=t.requestRewardedVideo=void 0;const i=s(9898);t.requestRewardedVideo=function(){return new Promise(((e,t)=>{window.famobi.hasRewardedAd()?window.famobi.rewardedAd((t=>{t.rewardGranted?e(!0):e(!1)})):i.GameConfig.USE_REWARDED_VIDEOS_ONLY?e(!1):window.famobi.showInterstitialAd({eventId:"Level:GetHint",callback:()=>{e(!0)}})}))},t.rewardedVideosEnabled=function(){return window.famobi.hasFeature("rewarded")}},9898:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameConfig=void 0,t.GameConfig={_SCALE:1,_MAX_RENDERER_WIDTH:4096,_MAX_RENDERER_HEIGHT:4096,_GAME_WIDTH:978,_GAME_HEIGHT:1656,FONTS:{MAIN:"Helvetica"},SHOW_LOADING_PROGRESS:!0,TRANSITION_SCREEN_COLORS:{DEFAULT:17408,BLACK:0,DARK_RED:7015701,LIGHT_BLUE:12647423},TRANSITION_SCREEN_DURATION:{IN:75,OUT:325},SETTINGS_BACKGROUND_COLOR:19203,DOUBLE_CLICK_MAX_DELAY_BETWEEN_CLICK:400,DRAG_TOLERANCE:3,GRAVITY_Y:3e3,DEFEAT_POPUP_COOLDOWN_IN_MOVES:5,CARD_ANIMATION_SPEED:{DEAL:1250,CANCEL_DRAG:2500,DROP_TO_NEW_PILE:1500,HINT:850,FLY_TO_FOUNDATION:3e3,FLY_TO_TABLEAU:2250,STOCK_TO_WASTE:1500,WASTE_TO_STOCK:1e3,UNDO_MOVE:2e3},PILE_GAP_X:15,CARD_PILE_OFFSET_Y:{FACE_DOWN:24,FACE_UP:59},TABLEAU_OFFSET_Y:50,FLIP_ANIM_DURATION:350,QUICK_FLIP_ANIM_DURATION:125,INITIAL_DEAL_DELAY_BETWEEN_CARDS:75,AUTOSOLVE_ANIMATION_DELAY_BETWEEN_CARDS:125,VICTORY_ANIMATION_DELAY_BETWEEN_CARDS:175,REWARDED_BUTTON_COOLODOWNS:{hint:5,undo:5},HINT_ANIMATIONS_REPEATS:2,USE_REWARDED_VIDEOS_ONLY:!0,CUSTOM_AUDIO_LOADING_LOGIC:!0,DESK_PADDING:{PORTRAIT:{W:60,H:60},LANDSCAPE:{W:60,H:60}},MAX_PORTRAIT_SCREEN_RATIO:1,ENABLE_LOCALIZATION:!0,getWidth(){return this._GAME_WIDTH*this._SCALE},getHeight(){return this._GAME_HEIGHT*this._SCALE},getScale(){return this._SCALE},debug:{cheats:!1,desk:!1}}},181:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardColor=void 0,function(e){e.RED="red",e.BLACK="black"}(t.CardColor||(t.CardColor={}))},7232:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function r(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CardPile=void 0;const n=s(7292),o=s(9898),r=s(2283),d=s(4353),h=s(1066),c=a(s(6756));class l extends Phaser.GameObjects.Container{constructor(e,t){var s,i,a,r,d,h;super(e.scene),this._pointerDown=!1,this._downX=0,this._downY=0,this.config=t,this.desk=e,this.gameplayScene=e.gameplayScene,this.faceDownOffsetY=null!==(s=t.faceDownOffsetY)&&void 0!==s?s:o.GameConfig.CARD_PILE_OFFSET_Y.FACE_DOWN,this.faceUpOffsetY=null!==(i=t.faceUpOffsetY)&&void 0!==i?i:o.GameConfig.CARD_PILE_OFFSET_Y.FACE_UP,this.cascadeShift=null!==(a=t.cascadeShift)&&void 0!==a&&a,this.allowAutoDropWithDoubleClick=null!==(r=t.allowAutoDropWithDoubleClick)&&void 0!==r&&r,this.resetCardOffsetXOnAdded=null===(d=t.resetCardOffsetXOnAdded)||void 0===d||d,this.debugBackground=this.scene.add.image(0,0,"white-square"),this.debugBackground.setDisplaySize(n.Card.WIDTH,n.Card.HEIGHT),this.debugBackground.setTint(16777215),this.debugBackground.alpha=.5,this.add(this.debugBackground),this.debugBackground.setVisible(o.GameConfig.debug.desk),this.glow=this.scene.add.image(0,0,"assets","card-glow-dynamic"),this.add(this.glow),this.glow.visible=!1,this.cardFrame=this.scene.add.image(0,0,"assets","card-place"),this.addAt(this.cardFrame,0),this.cardFrame.setVisible(null!==(h=this.config.displayCardFrame)&&void 0!==h&&h),this.inputCatcher=this.scene.add.image(0,0,"assets","card-place"),this.add(this.inputCatcher),this.inputCatcher.setAlpha(.001),this.inputCatcher.setInteractive(),this.inputCatcher.on(Phaser.Input.Events.POINTER_DOWN,this.handlePointerDown,this),this.inputCatcher.on(Phaser.Input.Events.POINTER_UP,this.handlePointerUp,this),this.cards=[]}highlight(e=2){this.scene.tweens.getTweensOf(this.glow).forEach((e=>e.destroy())),this.glow.visible=!0,this.glow.alpha=0,this.glowTween=this.scene.tweens.add({targets:this.glow,alpha:1,duration:375,yoyo:!0,repeat:e,ease:Phaser.Math.Easing.Linear})}resetHighlighting(){this.glowTween&&this.glowTween.isPlaying()&&(this.glowTween.destroy(),this.glow.alpha=0,this.glow.visible=!1)}getTopCard(){if(0!==this.cards.length)return this.cards[this.cards.length-1]}createCard(e){const t=this.scene.add.existing(new n.Card(this.desk,e.suit,e.rank,r.FlipStatus.BACK));this.add(t);const s={x:0,y:this.calculateNextCardY()};this.cards.push(t),t.setPile(this),t.pileOffsetY=s.y,t.setPosition(s.x,s.y)}addCard(e){const t=this.calculateNextCardY();this.cards.push(e),this.add(e),e.setPile(this),this.resetCardOffsetXOnAdded&&(e.pileOffsetX=0),e.pileOffsetY=t}removeCard(e){const t=this.cards.indexOf(e);-1!==t&&(e.setPile(null),this.cards.splice(t,1),-1!==this.getIndex(e)&&(this.remove(e),this.onCardRemoved(e)))}dropAllCardsAfterVictory(e=0){for(let t=0;t<this.cards.length;t++){const s=this.cards[t];s.parentContainer.remove(s),this.parentContainer.add(s),s.x+=this.x,s.y+=this.y,this.scene.time.delayedCall(e+(this.cards.length-1-t)*o.GameConfig.VICTORY_ANIMATION_DELAY_BETWEEN_CARDS,(()=>{s.dropped=!0,s.velocityX=Phaser.Math.Between(-350,800),s.velocityY=Phaser.Math.Between(-750,-250)}))}}getCards(){return this.cards.slice()}getNumCards(){return this.cards.length}isEmpty(){return 0===this.cards.length}isFull(){return 13===this.cards.length}getPrevCard(e){const t=this.cards.indexOf(e);return t<=0?null:this.cards[t-1]}getNextCard(e){const t=this.cards.indexOf(e);return t>=this.cards.length-1?null:this.cards[t+1]}resetCardPosition(e,t,s,a){return i(this,void 0,void 0,(function*(){t?yield this.tweenCardToPosition(e,e.pileOffsetX,e.pileOffsetY,s,a):e.setPosition(e.pileOffsetX,e.pileOffsetY)}))}tweenCardToPosition(e,t,s,i,a,n){return new Promise(((r,d)=>{const h=Phaser.Math.Distance.Between(e.x,e.y,t,s)/(null!=i?i:o.GameConfig.CARD_ANIMATION_SPEED.CANCEL_DRAG)*1e3;e.lockInput(),this.scene.tweens.add({targets:e,x:t,y:s,delay:null!=a?a:0,duration:h,ease:Phaser.Math.Easing.Sine.Out,onStart:()=>{const t=e.getPile();n&&t&&t.parentContainer.bringToTop(t)},onComplete:()=>{e.unlockInput(),r()}})}))}checkIfCardIsAbove(e){let t=e.x,s=e.y;const i=e.getPile(),a=i===this;i?(t+=i.x,s+=i.y,t-=this.x,s-=this.y):console.warn(`[Warn] Card ${e} does not have its source pile`);let o=0,r=0;const d=this.getTopCard();d&&!a&&(o+=d.x,r+=d.pileOffsetY);const h=Math.abs(t-o),c=Math.abs(s-r);return{result:h<=.6*n.Card.WIDTH&&c<=1.2*n.Card.HEIGHT,distance:Math.sqrt(h*h+c*c)}}debugSortCards(){this.cards.forEach((e=>{e.isFaceDown()&&e.setFlipStatus(r.FlipStatus.FRONT)})),this.cards.sort(((e,t)=>t.rank-e.rank)),this.cards.forEach((e=>{e.pileOffsetY=this.calculateCardY(e),this.resetCardPosition(e,!1)}));for(let e of this.cards)e.parentContainer.remove(e);for(let e of this.cards)this.add(e)}dispatchCardBeingDragged(e){const t=this.cards.indexOf(e);if(-1===t||t===this.cards.length-1)return;let s=e;for(let e=t+1;e<this.cards.length;e++){const t=this.cards[e];this.config.cascadeShift?t.setPosition(s.x,s.y+(s.isFaceUp()?o.GameConfig.CARD_PILE_OFFSET_Y.FACE_UP:o.GameConfig.CARD_PILE_OFFSET_Y.FACE_DOWN)):t.setPosition(s.x,s.y),s=t}}dispatchCardDropped(e){const t=this.desk.findTargetPileFor(e);t&&t.cardAllowedToBeDropped(e)?this.dropCardStackToOtherPile(e,t):this.tweenCardStackBackToItsSourcePosition(e)}onCardRemoved(e){}dropCardStackToOtherPile(e,t){const s=this.cards.indexOf(e);if(-1===s)return;d.SoundManager.instance.play("place_card");const i=[];for(let e=s;e<this.cards.length;e++){const t=this.cards[e];i.push(t)}const a=e.getPile(),n=null==a?void 0:a.getPrevCard(e),r=n&&n.isFaceUp(),c=[];for(let e of i)c.push(this.desk.moveCardToPile(e,t,o.GameConfig.CARD_ANIMATION_SPEED.DROP_TO_NEW_PILE,0,!1,!0));this.desk.cardsService.registerMove({cards:i,sourcePile:this,targetPile:t,zeroScore:!!r}),Promise.all(c).then((()=>{this.gameplayScene.events.emit(h.EventTypes.USER_MOVE_FINISHED)}))}tweenCardStackBackToItsSourcePosition(e){const t=this.cards.indexOf(e);if(-1!==t){d.SoundManager.instance.play("error");for(let e=t;e<this.cards.length;e++){const t=this.cards[e];this.resetCardPosition(t,!0,o.GameConfig.CARD_ANIMATION_SPEED.CANCEL_DRAG)}}}calculateNextCardY(){if(!this.config.cascadeShift)return 0;const e=this.getTopCard();return e?e.pileOffsetY+(e.isFaceUp()?o.GameConfig.CARD_PILE_OFFSET_Y.FACE_UP:o.GameConfig.CARD_PILE_OFFSET_Y.FACE_DOWN):0}calculateCardY(e){if(!this.config.cascadeShift)return 0;const t=this.getPrevCard(e);return t?t.pileOffsetY+(t.isFaceUp()?o.GameConfig.CARD_PILE_OFFSET_Y.FACE_UP:o.GameConfig.CARD_PILE_OFFSET_Y.FACE_DOWN):0}sendCardToFoundation(e){const t=this.desk.findFoundationPileFor(e);if(!t)return!1;const s=this.desk.moveCardToPile(e,t,o.GameConfig.CARD_ANIMATION_SPEED.FLY_TO_FOUNDATION,0,!0,!0);return this.desk.cardsService.registerMove({cards:[e],sourcePile:this,targetPile:t}),s.then((()=>{this.gameplayScene.events.emit(h.EventTypes.USER_MOVE_FINISHED)})),!0}sendCardToTableau(e){const t=this.desk.findTableauPileFor(e);return!!t&&(this.dropCardStackToOtherPile(e,t),!0)}handlePointerDown(e){c.default.instance.paused||(this._pointerDown=!0,this._downX=e.x,this._downY=e.y)}handlePointerUp(e){c.default.instance.paused||(this._pointerDown&&Phaser.Math.Distance.Between(e.x,e.y,this._downX,this._downY)<=1&&this.handleClick(),this._pointerDown=!1)}handleClick(){}destroy(e){this.inputCatcher.off(Phaser.Input.Events.POINTER_DOWN,this.handlePointerDown,this),this.inputCatcher.off(Phaser.Input.Events.POINTER_UP,this.handlePointerUp,this),super.destroy(e)}}t.CardPile=l},8628:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardRank=void 0,function(e){e[e.ACE=1]="ACE",e[e.RANK_2=2]="RANK_2",e[e.RANK_3=3]="RANK_3",e[e.RANK_4=4]="RANK_4",e[e.RANK_5=5]="RANK_5",e[e.RANK_6=6]="RANK_6",e[e.RANK_7=7]="RANK_7",e[e.RANK_8=8]="RANK_8",e[e.RANK_9=9]="RANK_9",e[e.RANK_10=10]="RANK_10",e[e.JACK=11]="JACK",e[e.QUEEN=12]="QUEEN",e[e.KING=13]="KING"}(t.CardRank||(t.CardRank={}))},9371:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardSuit=void 0,function(e){e.DIAMONDS="d",e.CLUBS="c",e.HEARTS="h",e.SPADES="s"}(t.CardSuit||(t.CardSuit={}))},1066:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventTypes=void 0,function(e){e.SCORE_CHANGED="score:changed",e.MOVES_AMOUNT_CHANGED="moves:changed",e.USER_INTERACTED="game:userInteracted",e.CARD_MOVED_BETWEEN_PILES="card:moved",e.UNDO_LAST_MOVE="game:undo",e.SET_UNDO_FEATURE_AVAILABLE="game:setUndoAvailable",e.SOUND_STATE_CHANGED="sound:changed",e.WASTE_MODE_CHANGED="wasteMode:changed",e.HAND_MODE_CHANGED="handMode:changed",e.SPAWN_CONFETTI="confetti:spawn",e.USER_MOVE_FINISHED="game:userMoveFinished",e.SHOW_DEFEAT_POPUP="game:showDefeatPopup",e.SHOW_HINT="game:showHint",e.GAME_PAUSED="game:paused",e.GAME_RESUMED="game:resumed",e.HINT_SUCCESSFUL="game:hintSuccessful",e.HINT_UNAVAILABLE="game:hintUnavailable"}(t.EventTypes||(t.EventTypes={}))},2283:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FlipStatus=void 0,function(e){e[e.FRONT=0]="FRONT",e[e.BACK=1]="BACK"}(t.FlipStatus||(t.FlipStatus={}))},4340:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HandMode=void 0,function(e){e.LEFT_HAND="left-hand",e.RIGHT_HAND="right-hand"}(t.HandMode||(t.HandMode={}))},1438:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MovePriority=void 0,function(e){e[e.FOUNDATION_TO_TABLEAU=1]="FOUNDATION_TO_TABLEAU",e[e.TABLEAU_TO_TABLEAU_REGULAR=5]="TABLEAU_TO_TABLEAU_REGULAR",e[e.STOCK_TO_WASTE=5]="STOCK_TO_WASTE",e[e.WASTE_TO_FOUNDATION=15]="WASTE_TO_FOUNDATION",e[e.WASTE_TO_TABLEAU=10]="WASTE_TO_TABLEAU",e[e.TABLEAU_TO_TABLEAU_UNCOVER=15]="TABLEAU_TO_TABLEAU_UNCOVER",e[e.TABLEAU_TO_FOUNDATION=15]="TABLEAU_TO_FOUNDATION"}(t.MovePriority||(t.MovePriority={}))},2149:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResponsivePositionData=void 0;class s{constructor(){this.x=0,this.y=0,this.dx=0,this.dy=0,this.scale=void 0}static clone(e){var t,i,a,n,o;let r=new s;return r.x=e.x,r.y=e.y,r.dx=e.dx,r.dy=e.dy,r.scale=e.scale,e.landscape&&(r.landscape={x:(null!==(t=e.landscape.x)&&void 0!==t?t:e.x)||0,y:(null!==(i=e.landscape.y)&&void 0!==i?i:e.y)||0,dx:(null!==(a=e.landscape.dx)&&void 0!==a?a:e.dx)||0,dy:(null!==(n=e.landscape.dy)&&void 0!==n?n:e.dy)||0,scale:null!==(o=e.landscape.scale)&&void 0!==o?o:e.scale}),r}}t.ResponsivePositionData=s},3825:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Scenes=void 0,function(e){e.PRELOAD="preload",e.GAMEPLAY="gameplay"}(t.Scenes||(t.Scenes={}))},929:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WasteMode=void 0,function(e){e.SINGLE_CARD="single",e.TRIPLE_CARD="triple"}(t.WasteMode||(t.WasteMode={}))},2921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfettiSpawner=void 0;class s{constructor(e,t,s){this.context=e,this.width=t,this.height=s,this.color=16777215,this.lightness=50,this.diameter=0,this.tilt=0,this.tiltAngleIncrement=0,this.tiltAngle=0,this.particleSpeed=Phaser.Math.Between(500,2e3),this.waveAngle=0,this.x=0,this.y=0,this.reset()}reset(){this.lightness=50,this.color=Math.floor(16777215*Math.random()),this.x=(Math.random()-.5)*this.width,this.y=Phaser.Math.FloatBetween(1.5*-this.height,.15*this.height),this.diameter=10*Math.random()+10,this.x-=this.diameter,this.tilt=0,this.tiltAngleIncrement=.1*Math.random()+.04,this.tiltAngle=0}darken(){this.y<100||this.lightness<=0||(this.lightness-=250/this.height)}update(e){const t=e/16.6667;this.waveAngle+=this.tiltAngleIncrement*t,this.tiltAngle+=this.tiltAngleIncrement*t,this.tilt=12*Math.sin(this.tiltAngle),this.x+=Math.sin(this.waveAngle),this.y+=(15*Math.cos(this.waveAngle)+45*this.diameter+this.particleSpeed)*e/1e3*.5,this.complete()&&this.reset(),this.darken()}complete(){return this.y>this.height+20}draw(){let e=this.x+this.tilt;this.context.lineStyle(this.diameter,this.color+this.lightness,1),this.context.beginPath(),this.context.moveTo(e+this.diameter/2,this.y),this.context.lineTo(e,this.y+this.tilt+this.diameter/2),this.context.closePath(),this.context.strokePath()}}class i extends Phaser.GameObjects.Container{constructor(e){super(e),this.context=this.scene.add.graphics(),this.add(this.context),this.createParticles(),this.hide(0)}createParticles(){let e=this.scene.cameras.main.width/this.scene.cameras.main.zoom,t=this.scene.cameras.main.height/this.scene.cameras.main.zoom;this.particles=[];for(let i=0;i<500;++i)this.particles.push(new s(this.context,e,t))}updateEffect(e){if(!this.visible)return;let t=this.scene.cameras.main,s=t.width/t.zoom*3,i=t.height/t.zoom*3;this.context.clear();for(let t in this.particles){let a=this.particles[t];a.width=s,a.height=i,a.update(e),a.draw()}}show(e){this.particles||this.createParticles(),this.visible=!0,this.alpha=0,this.scene&&(this.scene.tweens.add({targets:this,alpha:1,ease:Phaser.Math.Easing.Linear,duration:200}),this.lifeTimer&&this.lifeTimer.destroy&&(this.lifeTimer.destroy(),delete this.lifeTimer),this.lifeTimer=this.scene.time.addEvent({delay:e,callback:()=>this.hide(10)}))}hide(e){this.lifeTimer&&this.lifeTimer.destroy&&this.lifeTimer.destroy(),delete this.lifeTimer,0!=e?this.scene&&this.scene.tweens.add({targets:this,alpha:0,ease:Phaser.Math.Easing.Linear,duration:1e3,delay:e,onComplete:()=>this.visible=!1}):this.visible=!1}destroy(e){this.scene.tweens.getTweensOf(this).forEach((e=>e.stop())),super.destroy(e)}}t.ConfettiSpawner=i},6512:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundController=void 0;const a=i(s(2260)),n=s(9898);class o extends a.default.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.buildComponents()}preUpdate(e,t){}switchToMenuBackground(){this.background.tint=7829367,this.background.alpha=.25}switchToGameplayBackground(){this.background.tint=16777215,this.background.alpha=.75}buildComponents(){this.background=this.scene.add.image(0,0,"background"),this.add(this.background)}resize(e,t){e/t<=n.GameConfig.MAX_PORTRAIT_SCREEN_RATIO?(this.background.angle=-90,this.background.setScale(Math.max(e/this.background.height,t/this.background.width))):(this.background.angle=0,this.background.setScale(Math.max(e/this.background.width,t/this.background.height)))}}t.BackgroundController=o},4191:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ForegroundController=void 0;const a=i(s(2260)),n=s(9898);class o extends a.default.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.buildComponents()}preUpdate(e,t){}buildComponents(){window.famobi.hasFeature("copyright")&&(this.famobiLogo=this.scene.add.image(0,0,"famobi-logo"),this.famobiLogo.setOrigin(1,1),this.famobiLogo.setAlpha(.5),this.add(this.famobiLogo))}resize(e,t){this.famobiLogo&&(this.famobiLogo.setPosition(e/2-16,t/2-16),e/t>n.GameConfig.MAX_PORTRAIT_SCREEN_RATIO?this.famobiLogo.setScale(.7):this.famobiLogo.setScale(.5))}}t.ForegroundController=o},3408:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameDataManager=void 0;const i=s(1066),a=s(4340),n=s(929),o=s(4353),r=s(2728);t.GameDataManager=class{constructor(e){this._matchTime=0,this._victories=[0,0],this._totalMatches=[0,0],this._bestScore=[0,0],this._leastMoves=[void 0,void 0],this._bestTime=[void 0,void 0],this._totalTime=[0,0],this._handMode=a.HandMode.RIGHT_HAND,this._wasteMode=n.WasteMode.SINGLE_CARD,this._soundEnabled=!0,this.gameplayScene=e}loadSavedValues(){const e="undefined"!=typeof famobi?famobi.localStorage:window.localStorage;if(!e)return;let t=this.getDefaultSaveData();try{t=JSON.parse(e.getItem("solitaire"))}catch(e){}finally{t=null!=t?t:this.getDefaultSaveData(),this.soundEnabled=t.sound,this.wasteMode=t.wasteMode,this.handMode=t.handMode,this._victories=t.victories,this._totalMatches=t.totalMatches,this._bestScore=t.bestScore,this._leastMoves=t.leastMoves,this._bestTime=t.bestTime,this._totalTime=t.totalTime}}getDefaultSaveData(){return{sound:this.soundEnabled,wasteMode:this.wasteMode,handMode:this.handMode,victories:[0,0],totalMatches:[0,0],bestScore:[0,0],leastMoves:[void 0,void 0],bestTime:[void 0,void 0],totalTime:[0,0]}}resetGame(){this._matchTime=0,this.score=0,this.moves=0,this.started=!1,this.finished=!1,this.victory=!1,this.autoSolving=!1,this.paused=!1}saveData(){const e="undefined"!=typeof famobi?famobi.localStorage:window.localStorage;if(!e)return;const t={sound:this.soundEnabled,wasteMode:this.wasteMode,handMode:this.handMode,victories:this._victories,totalMatches:this._totalMatches,bestScore:this._bestScore,leastMoves:this._leastMoves,bestTime:this._bestTime,totalTime:this._totalTime};e.setItem("solitaire",JSON.stringify(t))}registerMatchStart(){this.setTotalMatches(this.getTotalMatches(this.wasteMode)+1,this.wasteMode),this.saveData()}registerVictory(){(!this.getBestTime(this.wasteMode)||this.matchTime<this.getBestTime(this.wasteMode))&&this.setBestTime(this.matchTime,this.wasteMode),this.setVictories(this.getVictories(this.wasteMode)+1,this.wasteMode),this.score>this.getBestScore(this.wasteMode)&&this.setBestScore(this.score,this.wasteMode),(!this.getLeastMoves(this.wasteMode)||this.moves<=this.getLeastMoves(this.wasteMode))&&this.setLeastMoves(this.moves,this.wasteMode),this.saveData()}update(e){if(this._started&&!this._finished&&!this.paused){this._matchTime+=e;const t=this.getTotalTime(this.wasteMode);this.setTotalTime(t+e,this.wasteMode)}}get matchTime(){return this._matchTime}getTotalTime(e){return this._totalTime[e===n.WasteMode.SINGLE_CARD?0:1]}setTotalTime(e,t){this._totalTime[t===n.WasteMode.SINGLE_CARD?0:1]=e}getBestTime(e){return this._bestTime[e===n.WasteMode.SINGLE_CARD?0:1]}setBestTime(e,t){this._bestTime[t===n.WasteMode.SINGLE_CARD?0:1]=e}getVictories(e){return this._victories[e===n.WasteMode.SINGLE_CARD?0:1]}setVictories(e,t){this._victories[t===n.WasteMode.SINGLE_CARD?0:1]=e}getTotalMatches(e){return this._totalMatches[e===n.WasteMode.SINGLE_CARD?0:1]}setTotalMatches(e,t){this._totalMatches[t===n.WasteMode.SINGLE_CARD?0:1]=e}getLeastMoves(e){return this._leastMoves[e===n.WasteMode.SINGLE_CARD?0:1]}setLeastMoves(e,t){this._leastMoves[t===n.WasteMode.SINGLE_CARD?0:1]=e}getBestScore(e){return this._bestScore[e===n.WasteMode.SINGLE_CARD?0:1]}setBestScore(e,t){this._bestScore[t===n.WasteMode.SINGLE_CARD?0:1]=e}get score(){return this._score}set score(e){this._score;this._score=Math.max(e,0),this.started&&!this.finished&&r.FamobiAPI.reportLiveScore(this._score),this.gameplayScene.events.emit(i.EventTypes.SCORE_CHANGED,this._score)}get started(){return this._started}set started(e){this._started=e}get finished(){return this._finished}set finished(e){this._finished=e}get victory(){return this._victory}set victory(e){this._victory=e}get moves(){return this._moves}set moves(e){this._moves=e,this.gameplayScene.events.emit(i.EventTypes.MOVES_AMOUNT_CHANGED,this._moves)}get handMode(){return this._handMode}set handMode(e){this._handMode=e,this.gameplayScene.events.emit(i.EventTypes.HAND_MODE_CHANGED,this._handMode)}get wasteMode(){return this._wasteMode}set wasteMode(e){this._wasteMode=e,this.gameplayScene.events.emit(i.EventTypes.WASTE_MODE_CHANGED,this._wasteMode)}get soundEnabled(){return this._soundEnabled}set soundEnabled(e){this._soundEnabled=e,this.gameplayScene.events.emit(i.EventTypes.SOUND_STATE_CHANGED,this._soundEnabled),o.SoundManager.instance.setGlobalVolume(this._soundEnabled?1:0)}get autoSolving(){return this._autoSolving}set autoSolving(e){this._autoSolving=e}get paused(){return this._paused}set paused(e){this._paused=e}}},6745:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function r(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GhostCard=void 0;const a=s(9898);class n extends Phaser.GameObjects.Container{constructor(e){super(e.scene),this.__destroyed=!1,this.alpha=.75,this.ghostCard=this.scene.add.image(0,0,"cards",e.generateCardFrameName()),this.add(this.ghostCard),this.glow=this.scene.add.image(0,0,"assets","card-glow-dynamic"),this.add(this.glow)}launch(e,t,s,n,o){return i(this,void 0,void 0,(function*(){this.setPosition(e,t),yield this.animateAppearing();const i=s.calculateNextCardY();yield this.flyTo(s.x,s.y+i+n,0,a.GameConfig.CARD_ANIMATION_SPEED.HINT),yield this.animateDisappearing(),!this.__destroyed&&o>0&&this.launch(e,t,s,n,o-1)}))}animateAppearing(){return this.__destroyed||!this.scene?Promise.resolve():new Promise(((e,t)=>{this.alpha=0,this.scale=.95,this._activeTween=this.scene.tweens.add({targets:this,scale:1,alpha:.8,duration:350,ease:Phaser.Math.Easing.Sine.In,onComplete:()=>{e()}})}))}animateDisappearing(){return this.__destroyed||!this.scene?Promise.resolve():new Promise(((e,t)=>{this._activeTween=this.scene.tweens.add({targets:this,alpha:0,delay:200,duration:150,ease:Phaser.Math.Easing.Sine.Out,onComplete:()=>{e()}})}))}flyTo(e,t,s,i){return this.__destroyed||!this.scene?Promise.resolve():new Promise(((n,o)=>{const r=Phaser.Math.Distance.Between(this.x,this.y,e,t),d=null!=i?i:a.GameConfig.CARD_ANIMATION_SPEED.HINT,h=Math.max(r/d*1e3,450);this._activeTween=this.scene.tweens.add({targets:this,x:e,y:t,delay:null!=s?s:0,duration:h,ease:Phaser.Math.Easing.Sine.InOut,onComplete:()=>{n()}})}))}destroy(e){this.__destroyed=!0,super.destroy(e)}}t.GhostCard=n},6602:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverlayScreen=void 0;const a=i(s(2260)),n=s(9898);class o extends a.default.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.buildComponents()}preUpdate(e,t){}resize(e,t){this.overlay.setDisplaySize(1.1*e,1.1*t)}buildComponents(){this.overlay=this.scene.add.image(0,0,"white-square"),this.overlay.setOrigin(.5,.5),this.overlay.setDisplaySize(n.GameConfig._MAX_RENDERER_WIDTH,n.GameConfig._MAX_RENDERER_HEIGHT),this.add(this.overlay),this.overlay.alpha=0,this.overlay.visible=!1}transition(e){const{callback:t,inDuration:s=n.GameConfig.TRANSITION_SCREEN_DURATION.IN,outDuration:i=n.GameConfig.TRANSITION_SCREEN_DURATION.OUT,skipFadeIn:o=!1,color:r=n.GameConfig.TRANSITION_SCREEN_COLORS.DEFAULT}=e;this.overlay.visible=!0,this.overlay.alpha=0,this.overlay.tint=r,o&&(this.overlay.alpha=1),this.scene.tweens.getTweensOf(this.overlay).forEach((e=>this.scene.tweens.remove(e))),this.scene.tweens.add({targets:this.overlay,alpha:1,duration:o?0:s,ease:a.default.Math.Easing.Sine.Out,onComplete:()=>{t&&t(),this.scene.tweens.add({targets:this.overlay,alpha:0,duration:i,ease:a.default.Math.Easing.Sine.In,onComplete:()=>{this.overlay.visible=!1}})}})}}t.OverlayScreen=o},5420:function(e,t,s){var i=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(s[i[a]]=e[i[a]])}return s},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScreensManager=void 0;const n=a(s(2260)),o=s(1183),r=s(59);class d extends n.default.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.initScreens()}initScreens(){this.activeScreens=[]}start(){this.changeScreen(o.Screen_MainMenu)}restart(){this.transitionTo(r.Screen_Gameplay,{callback:()=>{this.gameplayScene.dataManager.resetGame()}})}transitionTo(e,t={},s){const{callback:a}=t,n=i(t,["callback"]);this.gameplayScene.overlayScreen.transition(Object.assign({callback:()=>{this.changeScreen(e,s),a&&a()}},n))}getActiveScreen(){return this.activeScreens[this.activeScreens.length-1]}showScreen(e,t){const s=new e(this,t);this.add(s),s.show(),this.activeScreens.push(s)}changeScreen(e,t){this.hideAll(),this.showScreen(e,t)}showScreens(...e){e.forEach((e=>{this.showScreen(e)}))}hideScreen(...e){e.forEach((e=>{for(let t=this.activeScreens.length-1;t>-1;t--){const s=this.activeScreens[t];s instanceof e&&(this.activeScreens.splice(t,1),s.hide(),s.destroy())}}))}hideAll(){for(let e=this.activeScreens.length-1;e>-1;e--){const t=this.activeScreens[e];this.activeScreens.splice(e,1),t.hide(),t.destroy()}}preUpdate(e,t){this.activeScreens.forEach((s=>s.preUpdate(e,t)))}resize(e,t){this.activeScreens.forEach((s=>s.doResize(e,t)))}}t.ScreensManager=d},2688:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UIController=void 0;const a=i(s(2260)),n=s(1872),o=s(943);class r extends a.default.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.buildComponents()}buildComponents(){this.settingsMenu=this.scene.add.existing(new n.SettingsMenu(this.gameplayScene)),this.add(this.settingsMenu),this.tutorialPopup=this.scene.add.existing(new o.TutorialPopup(this.gameplayScene)),this.add(this.tutorialPopup)}resize(e,t){this.settingsMenu.resize(e,t),this.tutorialPopup.resize(e,t)}preUpdate(e,t){}showSettings(){this.settingsMenu.show()}showTutorialPopup(){this.tutorialPopup.show()}hideAll(){this.settingsMenu.hide(),this.tutorialPopup.hide()}}t.UIController=r},7292:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0;const a=s(8073),n=s(9898),o=s(8628),r=s(9371),d=s(2283),h=s(181),c=s(4353),l=s(1066),u=i(s(6756));class g extends Phaser.GameObjects.Container{constructor(e,t,s,i=d.FlipStatus.BACK){super(e.scene),this._lastClickTimestamp=0,this._pileOffsetX=0,this._pileOffsetY=0,this._isInputLocked=!1,this.dropped=!1,this.velocityX=0,this.velocityY=0,this.desk=e,this.gameplayScene=e.gameplayScene,this.suit=t,this.rank=s,this.perspectiveCard=this.scene.add.existing(new a.PerspectiveCard(this.gameplayScene,{back:{key:"cards",frame:"card-back"},front:{key:"cards",frame:this.generateCardFrameName()},face:i===d.FlipStatus.BACK?"back":"front",orientation:"horizontal",flip:{frontToBack:"left",backToFront:"right",duration:n.GameConfig.FLIP_ANIM_DURATION,ease:"Cubic",delay:0}})),this.add(this.perspectiveCard),this.glow=this.scene.add.image(0,0,"assets","card-glow-dynamic"),this.add(this.glow),this.glow.visible=!1,this.setInteractive({draggable:!0,hitArea:new Phaser.Geom.Rectangle(-g.WIDTH/2,-g.HEIGHT/2,g.WIDTH,g.HEIGHT),hitAreaCallback:Phaser.Geom.Rectangle.Contains}),this.on(Phaser.Input.Events.POINTER_DOWN,this.handlePointerDown,this),this.on(Phaser.Input.Events.DRAG_START,this.handleDragStart,this),this.on(Phaser.Input.Events.DRAG,this.handleDrag,this),this.on(Phaser.Input.Events.DRAG_END,this.handleDragEnd,this),this.on(Phaser.Input.Events.POINTER_UP,this.handlePointerUp,this)}get color(){return this.suit===r.CardSuit.HEARTS||this.suit===r.CardSuit.DIAMONDS?h.CardColor.RED:h.CardColor.BLACK}get pileOffsetX(){return this._pileOffsetX}set pileOffsetX(e){this._pileOffsetX=e}get pileOffsetY(){return this._pileOffsetY}set pileOffsetY(e){this._pileOffsetY=e}getPile(){return this.pile}setPile(e){this.pile=e}isFaceDown(){return this.perspectiveCard.face===d.FlipStatus.BACK}isFaceUp(){return this.perspectiveCard.face===d.FlipStatus.FRONT}getFlipStatus(){return this.perspectiveCard.face}setFlipStatus(e){this.perspectiveCard.setFace(e)}flip(e){this.getFlipStatus()===d.FlipStatus.BACK?this.flipToFace(e):this.flipToBack(e)}flipToFace(e,t=0){const s=()=>{var t;this.getFlipStatus()===d.FlipStatus.BACK&&(null===(t=this.perspectiveCard.flip)||void 0===t||t.flip(null!=e?e:n.GameConfig.FLIP_ANIM_DURATION))};t>0?this.scene.time.delayedCall(t,(()=>s())):s()}flipToBack(e,t=0){const s=()=>{var t;this.getFlipStatus()===d.FlipStatus.FRONT&&(null===(t=this.perspectiveCard.flip)||void 0===t||t.flip(null!=e?e:n.GameConfig.FLIP_ANIM_DURATION))};t>0?this.scene.time.delayedCall(t,(()=>s())):s()}isNextCardTo(e){return!!e&&(this.rank===e.rank+1&&this.suit===e.suit)}lockInput(){this._isInputLocked=!0}unlockInput(){this._isInputLocked=!1}isInputLocked(){return u.default.instance.paused||this._isInputLocked||this.desk.inputLocked||!this.gameplayScene.dataManager.started||this.gameplayScene.dataManager.finished}generateCardFrameName(){let e="";switch(this.rank){case o.CardRank.ACE:e="a";break;case o.CardRank.RANK_2:e="2";break;case o.CardRank.RANK_3:e="3";break;case o.CardRank.RANK_4:e="4";break;case o.CardRank.RANK_5:e="5";break;case o.CardRank.RANK_6:e="6";break;case o.CardRank.RANK_7:e="7";break;case o.CardRank.RANK_8:e="8";break;case o.CardRank.RANK_9:e="9";break;case o.CardRank.RANK_10:e="10";break;case o.CardRank.JACK:e="j";break;case o.CardRank.QUEEN:e="q";break;case o.CardRank.KING:e="k"}return e+this.suit}highlight(){this.scene.tweens.getTweensOf(this.glow).forEach((e=>e.destroy())),this.glow.visible=!0,this.glow.alpha=0,this.scene.tweens.add({targets:this.glow,alpha:1,duration:375,yoyo:!0,ease:Phaser.Math.Easing.Linear})}resetHighlighting(){this.scene}handlePointerDown(e){this.isInputLocked()||(this._pointerDown=!0,this._downX=e.x,this._downY=e.y,this.scene.events.emit(l.EventTypes.USER_INTERACTED))}handleDragStart(e){this.isInputLocked()||this.pile&&this.pile.parentContainer.bringToTop(this.pile)}handleDrag(e,t,s){this.isInputLocked()||this.pile&&!this.pile.isDragAllowed(this)||this._pointerDown&&Phaser.Math.Distance.Between(e.x,e.y,this._downX,this._downY)>n.GameConfig.DRAG_TOLERANCE&&(this._dragging||c.SoundManager.instance.play("pick_card"),this._dragging=!0,this.x=this.pileOffsetX+(t-this.pileOffsetX)/this.desk.scale,this.y=this.pileOffsetY+(s-this.pileOffsetY)/this.desk.scale,this.pile&&this.pile.dispatchCardBeingDragged(this))}handleDragEnd(e){if(!this.isInputLocked()){if(this._pointerDown)if(this._dragging)this.pile?(this.pile.parentContainer.bringToTop(this.pile),this.pile.dispatchCardDropped(this)):console.warn(`[Warn] Card ${this.toString()} has no parent pile`);else if(this.pile&&Phaser.Math.Distance.Between(this._downX,this._downY,e.x,e.y)<=n.GameConfig.DRAG_TOLERANCE){const e=this.scene.time.now,t=e-this._lastClickTimestamp;this.pile.allowAutoDropWithDoubleClick&&t<n.GameConfig.DOUBLE_CLICK_MAX_DELAY_BETWEEN_CLICK?(this.pile.dispatchCardDoubleClick(this),this._lastClickTimestamp=0):(this.pile.dispatchCardClick(this),this._lastClickTimestamp=e)}this._dragging=!1,this._pointerDown=!1}}handlePointerUp(e){this.isInputLocked()}toString(){return`${g.RANK_VALUES[this.rank]}${g.SUIT_ICONS[this.suit]}`}preUpdate(e,t){this.dropped&&(this.x+=this.velocityX*t/1e3,this.y+=this.velocityY*t/1e3,this.velocityY+=n.GameConfig.GRAVITY_Y*t/1e3)}destroy(e){this.disableInteractive(),this.off(Phaser.Input.Events.POINTER_DOWN,this.handlePointerDown,this),this.off(Phaser.Input.Events.DRAG_START,this.handleDragStart,this),this.off(Phaser.Input.Events.DRAG,this.handleDrag,this),this.off(Phaser.Input.Events.DRAG_END,this.handleDragEnd,this),this.off(Phaser.Input.Events.POINTER_UP,this.handlePointerUp,this),super.destroy(e)}}g.WIDTH=170,g.HEIGHT=236,g.SUIT_ICONS={d:"♦",c:"♣",h:"♥",s:"♠"},g.RANK_VALUES={1:"A",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"J",12:"Q",13:"K"},t.Card=g},9926:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Desk=void 0;const i=s(6198),a=s(9793),n=s(8617),o=s(7292),r=s(9898),d=s(2266),h=s(1066),c=s(4353),l=s(8459),u=s(4340),g=s(578),p=s(929),m=s(2728),_=s(6615),f=s(8628);class C extends Phaser.GameObjects.Container{constructor(e){super(e),this._inputLocked=!1,this.gameplayScene=e,this.cardsService=new l.CardsService(this),this.debugBackground=this.scene.add.image(0,0,"white-square"),this.debugBackground.setTint(16777215),this.debugBackground.alpha=.25,this.add(this.debugBackground),this.debugBackground.setVisible(r.GameConfig.debug.desk),this.stock=this.scene.add.existing(new i.Stock(this)),this.add(this.stock),this.stock.setName("Stock"),this.waste=this.scene.add.existing(new d.Waste(this)),this.add(this.waste),this.waste.setName("Waste"),this.foundations=[];for(let e=0;e<4;e++){const t=this.scene.add.existing(new n.FoundationPile(this));this.add(t),this.foundations.push(t),t.setName("Foundation_"+e)}this.tableau=[];for(let e=0;e<7;e++){const t=this.scene.add.existing(new a.TableauPile(this));this.add(t),this.tableau.push(t),t.setName("Tableau_"+e)}this.scene.events.emit(h.EventTypes.SET_UNDO_FEATURE_AVAILABLE,this.cardsService.isUndoPossible()),this.cardsService.dealCards().then((()=>{this.stock.cardsDealt=!0,this.gameplayScene.dataManager.started=!0})),this.addEventListeners()}addEventListeners(){this.scene.events.on(h.EventTypes.CARD_MOVED_BETWEEN_PILES,this.onCardMovedBetweenPiles,this),this.scene.events.on(h.EventTypes.UNDO_LAST_MOVE,this.undoLastMove,this),this.scene.events.on(h.EventTypes.HAND_MODE_CHANGED,this.onHandModeChanged,this),this.scene.events.on(h.EventTypes.WASTE_MODE_CHANGED,this.onWasteModeChanged,this),this.scene.events.on(h.EventTypes.USER_MOVE_FINISHED,this.onUserMoveFinished,this)}removeEventListeners(){this.scene.events.off(h.EventTypes.CARD_MOVED_BETWEEN_PILES,this.onCardMovedBetweenPiles,this),this.scene.events.off(h.EventTypes.UNDO_LAST_MOVE,this.undoLastMove,this),this.scene.events.off(h.EventTypes.HAND_MODE_CHANGED,this.onHandModeChanged,this),this.scene.events.off(h.EventTypes.WASTE_MODE_CHANGED,this.onWasteModeChanged,this),this.scene.events.off(h.EventTypes.USER_MOVE_FINISHED,this.onUserMoveFinished,this)}onHandModeChanged(){g.ResizeController.getInstance().forceResize()}onWasteModeChanged(){g.ResizeController.getInstance().forceResize()}undoLastMove(){var e;const t=this.cardsService.revertLastMove();if(t){if(this.scene.events.emit(h.EventTypes.SET_UNDO_FEATURE_AVAILABLE,!1),t.sourcePile.parentContainer.bringToTop(t.sourcePile),this.tableau.includes(t.sourcePile)){const e=t.sourcePile.getTopCard(),s=e?t.sourcePile.getPrevCard(e):null;!(null==e?void 0:e.isFaceUp())||(null==e?void 0:e.rank)===t.cards[0].rank+1&&(null==e?void 0:e.color)!==t.cards[0].color||s&&!s.isFaceDown()||null==e||e.flipToBack(150)}const s=[];for(let e of t.cards)e.isFaceUp()&&t.sourcePile===this.stock&&e.flipToBack(),e.isFaceDown()&&t.sourcePile===this.waste&&e.flipToFace(),s.push(this.moveCardToPile(e,t.sourcePile,r.GameConfig.CARD_ANIMATION_SPEED.UNDO_MOVE,0,!1,!1,!0));this.gameplayScene.dataManager.score-=null!==(e=t.score)&&void 0!==e?e:0,t.sourcePile===this.stock&&t.targetPile===this.waste&&this.gameplayScene.dataManager.wasteMode===p.WasteMode.TRIPLE_CARD&&(this.waste.resetBottomCardsPositions(3,!1),this.waste.unfoldTopThreeCards()),t.sourcePile===this.waste&&t.targetPile!==this.stock&&this.gameplayScene.dataManager.wasteMode===p.WasteMode.TRIPLE_CARD&&(this.waste.resetBottomCardsPositions(3,!1),this.waste.unfoldTopThreeCards()),this.gameplayScene.dataManager.finished&&(this.gameplayScene.dataManager.finished=!1,this.gameplayScene.dataManager.victory=!1),Promise.all(s).then((()=>{this.gameplayScene&&this.gameplayScene.time.delayedCall(100,(()=>{this.scene.events.emit(h.EventTypes.SET_UNDO_FEATURE_AVAILABLE,this.cardsService.isUndoPossible())}))}))}else c.SoundManager.instance.play("error"),this.scene.events.emit(h.EventTypes.SET_UNDO_FEATURE_AVAILABLE,this.cardsService.isUndoPossible())}onCardMovedBetweenPiles(e,t,s){t===this.waste&&s!==this.stock&&(this.cardsService.cardsMovedFromWasteSinceLastReset+=1)}checkMatchWinCondition(){return!(!this.gameplayScene.dataManager.started||this.gameplayScene.dataManager.finished||!this.foundations.every((e=>e.isFull())))&&(this.onGameFinished(),!0)}checkMatchDefeatCondition(){if(this.gameplayScene.dataManager.started&&!this.gameplayScene.dataManager.finished){if(this.cardsService.checkDefeat()&&this.cardsService.movesSinceLastDefeat<=0&&this.cardsService.wasteResetTimes>0)return this.gameplayScene.dataManager.finished=!0,this.gameplayScene.dataManager.victory=!1,this.cardsService.movesSinceLastDefeat=r.GameConfig.DEFEAT_POPUP_COOLDOWN_IN_MOVES,this.gameplayScene.time.delayedCall(750,(()=>{this.scene.events.emit(h.EventTypes.SHOW_DEFEAT_POPUP)})),!0}return!1}onUserMoveFinished(){this.checkMatchWinCondition()||this.checkMatchDefeatCondition()||(this.scene.events.emit(h.EventTypes.SET_UNDO_FEATURE_AVAILABLE,this.cardsService.isUndoPossible()),this.cardsService.areAllCardsOpened()&&(this.lockInput(),this.gameplayScene.dataManager.autoSolving=!0,this.scene.events.emit(h.EventTypes.SET_UNDO_FEATURE_AVAILABLE,!1),this.cardsService.autoSolve().then((()=>{this.checkMatchWinCondition(),this.gameplayScene.dataManager.autoSolving=!1,this.unlockInput()}))))}onGameFinished(){this.gameplayScene.dataManager.finished=!0,this.gameplayScene.dataManager.victory=!0,this.lockInput(),this.scene.events.emit(h.EventTypes.SPAWN_CONFETTI),c.SoundManager.instance.play("win"),this.gameplayScene.dataManager.registerVictory(),this.foundations.forEach(((e,t)=>{e.parentContainer.bringToTop(e),e.dropAllCardsAfterVictory(500+r.GameConfig.VICTORY_ANIMATION_DELAY_BETWEEN_CARDS/4*t)})),this.scene.time.delayedCall(2850,(()=>{window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Progression",progressionStatus:"Complete",progression01:this.gameplayScene.dataManager.wasteMode===p.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}),m.FamobiAPI.handleLevelEndEvent("success",this.gameplayScene.dataManager.score,(()=>{e()}));const e=()=>{setTimeout((()=>{Promise.all([window.famobi_analytics.trackEvent("EVENT_LEVELSUCCESS",{levelName:this.gameplayScene.dataManager.wasteMode===p.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}),window.famobi_analytics.trackEvent("EVENT_LEVELSCORE",{levelName:this.gameplayScene.dataManager.wasteMode===p.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS",levelScore:this.gameplayScene.dataManager.score})]).then((()=>{this.scene.time.delayedCall(500,(()=>{this.exitToMenu()}))}))}),500)}}))}exitToMenu(){window.famobi.showInterstitialAd({eventId:"Level:Finished",callback:()=>{this.gameplayScene.dataManager.saveData(),this.gameplayScene.screensManager.transitionTo(_.Screen_Statistics,{callback:()=>{this.gameplayScene.uiController.hideAll(),this.gameplayScene.dataManager.resetGame()}},{fromResults:!0})}})}moveAllToFoundations(){this.tableau.forEach((e=>{const t=e.getCards(),s=t.length;for(let e=t.length-1;e>-1;e--){const i=t[e];i.isFaceDown()&&i.flipToFace();const a=this.foundations.find((e=>e.cardAllowedToBeDropped(i)));this.moveCardToPile(i,a,r.GameConfig.CARD_ANIMATION_SPEED.DROP_TO_NEW_PILE,75*(s-1-e),!1)}}));const e=this.stock.getCards(),t=e.length;for(let s=e.length-1;s>0;s--){const i=e[s];i.isFaceDown()&&i.flipToFace();const a=this.foundations.find((e=>e.cardAllowedToBeDropped(i)));this.moveCardToPile(i,a,r.GameConfig.CARD_ANIMATION_SPEED.DROP_TO_NEW_PILE,75*(t-1-s),!1)}}moveCardToPile(e,t,s,i,a,r,d){return new Promise(((l,u)=>{let g=e.x,m=e.y;const _=e.getPile();if(_&&(g+=_.x,m+=_.y,_.removeCard(e)),g-=t.x,m-=t.y,t.addCard(e),e.setPosition(g,m),a&&this.scene.time.delayedCall(i||0,(()=>{t instanceof n.FoundationPile?c.SoundManager.instance.play("card_to_base"):c.SoundManager.instance.play("card",1,120)})),d&&t===this.waste&&this.gameplayScene.dataManager.wasteMode===p.WasteMode.TRIPLE_CARD){const t=this.waste.getPrevCard(e);e.pileOffsetX=Math.min(1.5*o.Card.WIDTH/2,t?t.pileOffsetX+o.Card.WIDTH/2:0)}t.tweenCardToPosition(e,e.pileOffsetX,e.pileOffsetY,s,i,r).then((()=>{this.scene&&(this.scene.events.emit(h.EventTypes.CARD_MOVED_BETWEEN_PILES,e,_,t),l())}))}))}autoDropCardTo(e,t,s){const i=e.getPile();if(!i)return Promise.resolve();const a=this.moveCardToPile(e,t,r.GameConfig.CARD_ANIMATION_SPEED.FLY_TO_FOUNDATION,s,!0,!0);return this.cardsService.registerMove({cards:[e],sourcePile:i,targetPile:t}),a}findTableauPileFor(e){return this.tableau.find((t=>t.isEmpty()&&e.rank===f.CardRank.KING||t.cardAllowedToBeDropped(e)))}findFoundationPileFor(e){return this.foundations.find((t=>t.isEmpty()&&e.rank===f.CardRank.ACE||e.isNextCardTo(t.getTopCard())))}findTargetPileFor(e){const t=[...this.foundations,...this.tableau],s=[];for(let i of t){const t=i.checkIfCardIsAbove(e);t.result&&s.push({pile:i,distance:t.distance})}if(s.length>0){let e,t=Number.MAX_VALUE;for(let i of s)i.distance<t&&(e=i.pile,t=i.distance);return e}}get inputLocked(){return this._inputLocked}lockInput(){this._inputLocked=!0}unlockInput(){this._inputLocked=!1}resizePortrait(e,t){const s=this.getDisplayBounds();this.debugBackground.setDisplaySize(s.width,s.height),this.tableau.forEach(((e,t)=>{const i=-s.width/2+(t+.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),a=-s.height/2+1.5*o.Card.HEIGHT+r.GameConfig.TABLEAU_OFFSET_Y;e.setPosition(i,a)})),this.gameplayScene.dataManager.handMode===u.HandMode.RIGHT_HAND?(this.foundations.forEach(((e,t)=>{const i=-s.width/2+(t+.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),a=-s.height/2+o.Card.HEIGHT/2;e.setPosition(i,a)})),this.waste.setPosition(-s.width/2+(this.gameplayScene.dataManager.wasteMode===p.WasteMode.TRIPLE_CARD?4.5:5.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT),this.stock.setPosition(-s.width/2+6.5*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT)):(this.foundations.forEach(((e,t)=>{const i=-s.width/2+(t+3.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),a=-s.height/2+o.Card.HEIGHT/2;e.setPosition(i,a)})),this.waste.setPosition(-s.width/2+1.5*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT),this.stock.setPosition(-s.width/2+.5*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT)),this.setScale(Math.min(e/s.width,t/s.height)),this.setPosition(0,-t/2+s.height/2*this.scale)}resizeLandscape(e,t){const s=this.getDisplayBounds();this.debugBackground.setDisplaySize(s.width,s.height),this.tableau.forEach(((e,t)=>{const i=-s.width/2+(t+.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),a=-s.height/2+1.5*o.Card.HEIGHT+r.GameConfig.TABLEAU_OFFSET_Y;e.setPosition(i,a)})),this.gameplayScene.dataManager.handMode===u.HandMode.RIGHT_HAND?(this.foundations.forEach(((e,t)=>{const i=-s.width/2+(t+.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),a=-s.height/2+o.Card.HEIGHT/2;e.setPosition(i,a)})),this.waste.setPosition(-s.width/2+(this.gameplayScene.dataManager.wasteMode===p.WasteMode.TRIPLE_CARD?4.5:5.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT),this.stock.setPosition(-s.width/2+6.5*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT)):(this.foundations.forEach(((e,t)=>{const i=-s.width/2+(t+3.5)*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),a=-s.height/2+o.Card.HEIGHT/2;e.setPosition(i,a)})),this.waste.setPosition(-s.width/2+1.5*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT),this.stock.setPosition(-s.width/2+.5*(o.Card.WIDTH+r.GameConfig.PILE_GAP_X),-s.height/2+.5*o.Card.HEIGHT)),this.setScale(Math.min(e/s.width,t/s.height)),this.setPosition(0,0)}getDisplayBounds(){const e={width:0,height:0};return e.width=7*o.Card.WIDTH+6*r.GameConfig.PILE_GAP_X,e.height=o.Card.HEIGHT+r.GameConfig.TABLEAU_OFFSET_Y+o.Card.HEIGHT+7*r.GameConfig.CARD_PILE_OFFSET_Y.FACE_DOWN+13*r.GameConfig.CARD_PILE_OFFSET_Y.FACE_UP,e}destroy(e){this.removeEventListeners(),this.cardsService.destroy(),super.destroy(e)}}t.Desk=C},6666:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GUIPanel=void 0;const i=s(5934),a=s(9898),n=s(272),o=s(1066),r=s(8116),d=s(3786),h=s(4353);class c extends Phaser.GameObjects.Container{constructor(e){super(e),this._undoCheckCooldown=1e3,this._undoAvailable=!0,this.gameplayScene=e,this.panel=this.scene.add.image(0,0,"white-square"),this.panel.tint=19712,this.add(this.panel),this.iconScore=this.scene.add.image(0,0,"assets","icon-score"),this.add(this.iconScore),this.textScoreContainer=this.scene.add.container(),this.add(this.textScoreContainer),this.textScore=this.scene.add.text(0,0,`${this.gameplayScene.dataManager.score}`,{fontFamily:a.GameConfig.FONTS.MAIN,fontSize:"80px",color:"#ffffff",align:"center"}),this.textScore.setOrigin(.5,.5),this.textScoreContainer.add(this.textScore),this.iconTime=this.scene.add.image(0,0,"assets","icon-time"),this.add(this.iconTime),this.textTimeContainer=this.scene.add.container(),this.add(this.textTimeContainer),this.textTime=this.scene.add.text(0,0,"00:00",{fontFamily:a.GameConfig.FONTS.MAIN,fontSize:"80px",color:"#ffffff",align:"center"}),this.textTime.setOrigin(.5,.5),this.textTimeContainer.add(this.textTime),this.iconMoves=this.scene.add.image(0,0,"assets","icon-moves"),this.add(this.iconMoves),this.textMovesContainer=this.scene.add.container(),this.add(this.textMovesContainer),this.textMoves=this.scene.add.text(0,0,`${this.gameplayScene.dataManager.moves}`,{fontFamily:a.GameConfig.FONTS.MAIN,fontSize:"80px",color:"#ffffff",align:"center"}),this.textMoves.setOrigin(.5,.5),this.textMovesContainer.add(this.textMoves),this.buttonsContainer=this.scene.add.container(),this.add(this.buttonsContainer),this.buttonSettings=this.scene.add.existing(new i.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-settings",clickCallback:()=>this.onSettingsClicked()})),this.buttonsContainer.add(this.buttonSettings),this.buttonUndo=this.scene.add.existing(new r.RewardedButton({scene:this.gameplayScene,texture:"assets",frame:"button-undo",text:"x",textStyle:{fontFamily:a.GameConfig.FONTS.MAIN,fontSize:"32px",color:"#ffffff",align:"center"},dataKey:"undo",textPosition:{x:34,y:34},rewardedFrame:"button-undo-rewarded",rewardedPeriod:5,lazyAction:!1,rewardedCallback:()=>(0,d.requestRewardedVideo)(),clickCallback:()=>this.onUndoClicked()})),this.buttonsContainer.add(this.buttonUndo),this.buttonHint=this.scene.add.existing(new r.RewardedButton({scene:this.gameplayScene,texture:"assets",frame:"button-hint",text:"x",textStyle:{fontFamily:a.GameConfig.FONTS.MAIN,fontSize:"32px",color:"#ffffff",align:"center"},dataKey:"hint",textPosition:{x:35,y:34},rewardedFrame:"button-hint-rewarded",rewardedPeriod:5,lazyAction:!0,rewardedCallback:()=>(0,d.requestRewardedVideo)(),clickCallback:()=>this.onHintClicked()})),this.buttonsContainer.add(this.buttonHint),this.addEventListeners()}addEventListeners(){this.scene.events.on(o.EventTypes.SCORE_CHANGED,this._updateScore,this),this.scene.events.on(o.EventTypes.MOVES_AMOUNT_CHANGED,this._updateMoves,this),this.scene.events.on(o.EventTypes.SET_UNDO_FEATURE_AVAILABLE,this._setUndoAvailable,this),this.scene.events.on(o.EventTypes.HINT_SUCCESSFUL,this._onHintSuccessful,this),this.scene.events.on(o.EventTypes.HINT_UNAVAILABLE,this._onHintUnavailable,this)}removeEventListeners(){this.scene.events.off(o.EventTypes.SCORE_CHANGED,this._updateScore,this),this.scene.events.off(o.EventTypes.MOVES_AMOUNT_CHANGED,this._updateMoves,this),this.scene.events.off(o.EventTypes.SET_UNDO_FEATURE_AVAILABLE,this._setUndoAvailable,this),this.scene.events.off(o.EventTypes.HINT_SUCCESSFUL,this._onHintSuccessful,this),this.scene.events.off(o.EventTypes.HINT_UNAVAILABLE,this._onHintUnavailable,this)}resizePortrait(e,t){this.panel.setDisplaySize(e,t);const s=1.05,i=.65*s;this.iconMoves.setPosition(0*-e+10,-34).setScale(.525),this.textMovesContainer.setPosition(this.iconMoves.x+this.iconMoves.displayWidth/2+10,-34).setScale(i),this.textMoves.setOrigin(0,.5),this.iconTime.setPosition(0*-e+10,34).setScale(.525).setVisible(!0),this.textTimeContainer.setPosition(this.iconTime.x+this.iconTime.displayWidth/2+10,34).setScale(i),this.textTime.setOrigin(0,.5),this.iconScore.setPosition(.45*e-35,0).setScale(.875175).setVisible(!0),this.textScoreContainer.setPosition(.45*e-35-this.iconScore.displayWidth/2-10,0).setScale(1.667*i),this.textScore.setOrigin(1,.5),this.buttonsContainer.setPosition(.45*-e+189,0),this.buttonsContainer.setScale(s),this.buttonSettings.setPosition(-124,0),this.buttonHint.setPosition(0,0),this.buttonUndo.setPosition(124,0)}resizeLandscape(e,t){this.panel.setDisplaySize(e,t);const s=Phaser.Math.Clamp(e/175,1,3),i=.45*t,a=.5*s,n=.4*-t+40*s,o=(i-372*s-.075*t-n)/s,r=o>175?(o-175)/4:0;if(o>250){const e=1.2;this.iconScore.setPosition(0,n-50*s).setScale(.5*s*e),this.textScoreContainer.setPosition(0,n+10*s).setScale(1.5*a*e),this.textScore.setOrigin(.5,.5),this.iconTime.setPosition(0,n+(65+r)*s*e).setScale(.5*s*e).setVisible(!0),this.textTimeContainer.setPosition(0,n+(115+r)*s*e).setScale(a*e),this.textTime.setOrigin(.5,.5),this.iconMoves.setPosition(0,n+(155+2*r)*s*e).setScale(.5*s*e),this.textMovesContainer.setPosition(0,n+(195+2*r)*s*e).setScale(1.1*a*e),this.textMoves.setOrigin(.5,.5)}else this.iconScore.setPosition(0,n-50*s).setScale(.5*s),this.textScoreContainer.setPosition(0,n+5*s).setScale(1.5*a),this.textScore.setOrigin(.5,.5),this.iconTime.setPosition(-55*s,n+(80+r)*s).setScale(.35*s).setVisible(!0),this.textTimeContainer.setPosition(this.iconTime.x+this.iconTime.displayWidth/2+15,n+(80+r)*s).setScale(a),this.textTime.setOrigin(0,.5),this.iconMoves.setPosition(-15*s,n+(150+2*r)*s).setScale(.4*s),this.textMovesContainer.setPosition(this.iconMoves.x+this.iconMoves.displayWidth/2+10,n+(150+2*r)*s).setScale(a),this.textMoves.setOrigin(0,.5);const d=372*s/t>.45?.45/(372*s/t):1;this.buttonsContainer.setPosition(0,i),this.buttonsContainer.setScale(s*d),this.buttonUndo.setPosition(0,-310),this.buttonHint.setPosition(0,-186),this.buttonSettings.setPosition(0,-62)}preUpdate(e,t){this.textTime.setText(n.Utils.humanizeTimeShort(this.gameplayScene.dataManager.matchTime));const s=this.buttonHint.isEnabled(),i=this.gameplayScene.dataManager.started&&!this.gameplayScene.dataManager.finished||this.gameplayScene.dataManager.autoSolving;s!==i&&this.buttonHint.setEnabled(i),(0,d.rewardedVideosEnabled)()&&!this.buttonUndo.isEnabled()&&this._undoAvailable&&(this._undoCheckCooldown-=t,this._undoCheckCooldown<=0&&(famobi.hasRewardedAd()&&this.buttonUndo.setEnabled(!0),this._undoCheckCooldown=1e3))}_setUndoAvailable(e){this._undoAvailable=e,this.buttonUndo.setEnabled(e)}_onHintUnavailable(){h.SoundManager.instance.play("error"),this.buttonHint.blinkRed()}_onHintSuccessful(){this.buttonHint.registerLazyAttempt()}_updateScore(e){this.textScore.text!==`${e}`&&(this.textScore.setText(`${e}`),this.textScore.text.length>3?this.textScore.setFontSize(240/this.textScore.text.length):this.textScore.setFontSize(80),this.textScore.setScale(.75),this.scene.tweens.add({targets:this.textScore,scale:1,duration:175,ease:Phaser.Math.Easing.Back.Out}))}_updateMoves(e){this.textMoves.text!==`${e}`&&(this.textMoves.setText(`${e}`),this.textMoves.setScale(.75),this.scene.tweens.add({targets:this.textMoves,scale:1,duration:175,ease:Phaser.Math.Easing.Back.Out}))}onSettingsClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Gameplay:Pause"}),window.famobi_analytics.trackEvent("EVENT_PAUSE").then((()=>{this.scene.events.emit(o.EventTypes.USER_INTERACTED),a.GameConfig.debug.cheats?this.gameplayScene.getActiveScreen().gamePanel.desk.cardsService.autoMove():this.gameplayScene.uiController.showSettings()}))}onUndoClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Gameplay:UndoMove"}),this.scene.events.emit(o.EventTypes.USER_INTERACTED),this.scene.events.emit(o.EventTypes.UNDO_LAST_MOVE)}onHintClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Gameplay:GetHint"}),this.scene.events.emit(o.EventTypes.USER_INTERACTED),this.scene.events.emit(o.EventTypes.SHOW_HINT)}destroy(e){this.removeEventListeners(),super.destroy(e)}}t.GUIPanel=c},9529:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GamePanel=void 0;const i=s(9926),a=s(9898);class n extends Phaser.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.background=this.scene.add.image(0,0,"white-square"),this.background.setTint(43776,27136,43776,27136),this.background.alpha=.5,this.add(this.background),this.desk=this.scene.add.existing(new i.Desk(this.gameplayScene)),this.add(this.desk)}resizePortrait(e,t){this.background.setDisplaySize(e,t),this.background.setTint(43776,43776,27136,27136),this.desk.resizePortrait(e-a.GameConfig.DESK_PADDING.PORTRAIT.W,t-a.GameConfig.DESK_PADDING.PORTRAIT.H)}resizeLandscape(e,t){this.background.setDisplaySize(e,t),this.background.setTint(43776,27136,43776,27136),this.desk.resizeLandscape(e-a.GameConfig.DESK_PADDING.LANDSCAPE.W,t-a.GameConfig.DESK_PADDING.LANDSCAPE.H)}destroy(e){super.destroy(e)}}t.GamePanel=n},8617:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FoundationPile=void 0;const i=s(7232),a=s(8628),n=s(9898);class o extends i.CardPile{constructor(e){super(e,{allowAutoDropWithDoubleClick:!0,displayCardFrame:!0,cascadeShift:!1})}cardAllowedToBeDropped(e,t=!1){if(n.GameConfig.debug.cheats)return this.cards.length<13;const s=e.getPile();if(s===this)return!1;if(!t&&s&&s.getTopCard()!==e)return!1;const i=this.getTopCard();return i?e.isNextCardTo(i):e.rank===a.CardRank.ACE}isDragAllowed(e){return!0}dispatchCardClick(e){}dispatchCardDoubleClick(e){this.allowAutoDropWithDoubleClick&&e.isFaceUp()&&(e!==this.getTopCard()||this.sendCardToTableau(e))}}t.FoundationPile=o},6198:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Stock=void 0;const i=s(7232),a=s(7292),n=s(9898),o=s(4340),r=s(1066),d=s(929);class h extends i.CardPile{constructor(e){super(e,{cascadeShift:!1,displayCardFrame:!0}),this.cardsDealt=!1,this.cardFrame.setFrame("icon-empty"),this.generateInitialCards(),this.addEventsListeners()}addEventsListeners(){this.scene.events.on(r.EventTypes.HAND_MODE_CHANGED,this.onHandModeChanged,this)}removeEventsListeners(){this.scene.events.off(r.EventTypes.HAND_MODE_CHANGED,this.onHandModeChanged,this)}onHandModeChanged(){this.cardsDealt||this.cards.forEach((e=>{const t=this.gameplayScene.dataManager.handMode===o.HandMode.RIGHT_HAND?-2*(a.Card.WIDTH+n.GameConfig.PILE_GAP_X):2*(a.Card.WIDTH+n.GameConfig.PILE_GAP_X);e.x=t}))}generateInitialCards(){const e=this.desk.cardsService.generateShuffledDeck();this.cards=[],e.forEach(((e,t)=>{this.createCard(e)})),this.onHandModeChanged()}resetCardsToTheirInitialPosition(e,t){const s=[];for(let i=0;i<this.cards.length-28;i++){const a=this.cards[i],o=this.resetCardPosition(a,!0,n.GameConfig.CARD_ANIMATION_SPEED.DEAL,e+i*t);s.push(o)}return s}cardAllowedToBeDropped(e){return!1}isDragAllowed(e){return!1}dispatchCardClick(e){if(e===this.getTopCard()){let e=this.getCardsToBeMovedToWaste();const t=[];e.forEach(((e,s)=>{const i=60*s;e.isFaceDown()&&e.flipToFace(n.GameConfig.QUICK_FLIP_ANIM_DURATION,i+20),e.pileOffsetX=a.Card.WIDTH/2*s,t.push(this.desk.moveCardToPile(e,this.desk.waste,n.GameConfig.CARD_ANIMATION_SPEED.STOCK_TO_WASTE,i,!0,!0))})),this.desk.cardsService.registerMove({cards:e.reverse(),sourcePile:this,targetPile:this.desk.waste}),this.desk.waste.resetBottomCardsPositions(e.length,!0),Promise.all(t).then((()=>{this.gameplayScene.events.emit(r.EventTypes.USER_MOVE_FINISHED)}))}}dispatchCardDoubleClick(e){}getExtractableCards(e){const t=[...this.cards,...e.reverse()];return 0===t.length?[]:this.gameplayScene.dataManager.wasteMode===d.WasteMode.SINGLE_CARD?t:t.length<3?[t[0]]:t.filter(((e,s)=>(t.length-1-s)%3==2))}getCardsToBeMovedToWaste(){if(0===this.cards.length)return[];if(this.gameplayScene.dataManager.wasteMode===d.WasteMode.TRIPLE_CARD){const e=[];for(let t=this.cards.length-1,s=3;t>-1&&s>0;t--,s--)e.push(this.cards[t]);return e}return[this.cards[this.cards.length-1]]}handleClick(){this.scene.events.emit(r.EventTypes.USER_INTERACTED),0===this.cards.length&&this.desk.waste.getNumCards()>0&&(this.desk.lockInput(),this.desk.cardsService.resetWaste().then((()=>{this.desk.unlockInput()})))}preUpdate(e,t){this.cardFrame.alpha=.25,this.cardFrame.visible=this.cardsDealt&&0===this.cards.length,this.cardFrame.setInteractive({alphaTolerance:0})}destroy(e){this.removeEventsListeners(),super.destroy(e)}}t.Stock=h},9793:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TableauPile=void 0;const i=s(7232),a=s(8628),n=s(9898);class o extends i.CardPile{constructor(e){super(e,{cascadeShift:!0,displayCardFrame:!0,allowAutoDropWithDoubleClick:!0}),this.cardFrame.alpha=.4}onCardRemoved(e){const t=this.getTopCard();t&&t.isFaceDown()&&t.flipToFace(n.GameConfig.FLIP_ANIM_DURATION,50)}getFirstOpenedCard(){if(0!==this.cards.length)for(let e of this.cards)if(e.isFaceUp())return e}cardAllowedToBeDropped(e){if(n.GameConfig.debug.cheats)return!0;const t=this.getTopCard();return t?e.rank===t.rank-1&&e.color!==t.color:e.rank===a.CardRank.KING}isDragAllowed(e){return e.isFaceUp()}dispatchCardClick(e){e===this.getTopCard()&&e.isFaceDown()&&e.flip()}dispatchCardDoubleClick(e){this.allowAutoDropWithDoubleClick&&e.isFaceUp()&&(e===this.getTopCard()&&this.sendCardToFoundation(e)||this.sendCardToTableau(e))}}t.TableauPile=o},2266:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Waste=void 0;const i=s(7232),a=s(7292),n=s(9898),o=s(929);class r extends i.CardPile{constructor(e){super(e,{resetCardOffsetXOnAdded:!1,allowAutoDropWithDoubleClick:!0})}cardAllowedToBeDropped(e){return!1}dispatchCardClick(e){}isDragAllowed(e){return e&&e===this.getTopCard()}resetBottomCardsPositions(e,t){for(let s=0;s<this.cards.length-e;s++)this.cards[s].pileOffsetX=0,this.resetCardPosition(this.cards[s],t,n.GameConfig.CARD_ANIMATION_SPEED.STOCK_TO_WASTE)}unfoldTopThreeCards(){for(let e=Math.max(0,this.cards.length-3),t=0;e<this.cards.length;e++,t++)this.cards[e].pileOffsetX=a.Card.WIDTH/2*t,this.resetCardPosition(this.cards[e],!0,n.GameConfig.CARD_ANIMATION_SPEED.STOCK_TO_WASTE)}getAvailableCards(){return this.gameplayScene.dataManager.wasteMode===o.WasteMode.SINGLE_CARD?this.cards.slice():this.cards.filter(((e,t)=>(this.cards.length-1-t)%3==0))}dispatchCardDoubleClick(e){this.allowAutoDropWithDoubleClick&&e.isFaceUp()&&(e===this.getTopCard()&&this.sendCardToFoundation(e)||e!==this.getTopCard()||this.sendCardToTableau(e))}}t.Waste=r},5870:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DefeatPopup=void 0;const a=i(s(2260)),n=s(9898),o=s(5934),r=s(1066),d=s(8116),h=s(3786),c=s(929),l=s(8891);class u extends a.default.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.overlay=this.scene.add.image(0,0,"white-square"),this.overlay.setOrigin(.5,.5),this.overlay.setDisplaySize(n.GameConfig._MAX_RENDERER_WIDTH,n.GameConfig._MAX_RENDERER_HEIGHT),this.add(this.overlay),this.overlay.setInteractive(),this.overlay.tint=0,this.overlay.alpha=.5,this.overlay.visible=!0,this.contentContainer=this.scene.add.container(),this.add(this.contentContainer),this.panel=this.scene.add.image(0,0,"assets","defeat-panel"),this.contentContainer.add(this.panel),this.panel.setScale(2),this.noMovesIcon=this.scene.add.image(0,-200,"assets","icon-no-moves"),this.noMovesIcon.scale=1,this.contentContainer.add(this.noMovesIcon),this.noMoreMovesText=this.scene.add.text(0,15,l.LocalizationManager.getInstance().getText("no_moves_left"),{fontFamily:n.GameConfig.FONTS.MAIN,fontSize:"52px",color:"#ffffff",align:"center",wordWrap:{useAdvancedWrap:!0,width:680},lineSpacing:-2}),this.noMoreMovesText.setOrigin(.5),this.contentContainer.add(this.noMoreMovesText),this.buttonClose=this.scene.add.existing(new o.BasicButton({scene:this.gameplayScene,x:335,y:-335,texture:"assets",frame:"icon-close",scale:.6,clickCallback:()=>this.onCloseClicked()})),this.buttonClose.alpha=.667,this.contentContainer.add(this.buttonClose),this.buttonRestart=this.scene.add.existing(new o.BasicButton({scene:this.gameplayScene,x:-130,y:225,texture:"assets",frame:"button-restart",scale:1.5*1.333,clickCallback:()=>this.onRestartClicked()})),this.contentContainer.add(this.buttonRestart),this.buttonUndo=this.scene.add.existing(new d.RewardedButton({scene:this.gameplayScene,x:130,y:225,scale:1.5*1.333,texture:"assets",frame:"button-undo",text:"x",textStyle:{fontFamily:n.GameConfig.FONTS.MAIN,fontSize:"32px",color:"#ffffff",align:"center"},dataKey:"undo",textPosition:{x:34,y:34},rewardedFrame:"button-undo-rewarded",rewardedPeriod:5,lazyAction:!1,rewardedCallback:()=>(0,h.requestRewardedVideo)(),clickCallback:()=>this.onUndoClicked()})),this.contentContainer.add(this.buttonUndo),this.visible=!1,this.scene.events.on(r.EventTypes.SHOW_DEFEAT_POPUP,this.show,this)}show(){this.visible=!0,this.buttonUndo.updateView(),this.overlay.alpha=0,this.scene.tweens.add({targets:this.overlay,alpha:.625,duration:125,ease:a.default.Math.Easing.Sine.Out}),this.contentContainer.scale=1.25,this.scene.tweens.add({targets:this.contentContainer,scale:1,duration:350,ease:a.default.Math.Easing.Back.Out}),this.contentContainer.alpha=0,this.scene.tweens.add({targets:this.contentContainer,alpha:1,duration:125,ease:a.default.Math.Easing.Sine.Out})}hide(){return new Promise(((e,t)=>{this.scene.tweens.add({targets:this.contentContainer,y:100,alpha:0,duration:50,ease:a.default.Math.Easing.Sine.Out}),this.scene.tweens.add({targets:this.overlay,alpha:0,duration:50,ease:a.default.Math.Easing.Linear,onComplete:()=>{this.visible=!1,e()}})}))}resizePortrait(e,t){this.overlay.setDisplaySize(e,t)}resizeLandscape(e,t){this.overlay.setDisplaySize(e,t)}onRestartClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Results:Restart"}),window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Progression",progressionStatus:"Fail",progression01:this.gameplayScene.dataManager.wasteMode===c.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}),window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:this.gameplayScene.dataManager.wasteMode===c.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS",reason:"quit"}).then((()=>{window.famobi.showInterstitialAd({eventId:"Button:Pause:Quit",callback:()=>{window.famobi_analytics.trackEvent("EVENT_LEVELRESTART",{levelName:this.gameplayScene.dataManager.wasteMode===c.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}).then((()=>{this.gameplayScene.dataManager.finished=!0,this.gameplayScene.dataManager.victory=!1,this.gameplayScene.dataManager.saveData(),this.gameplayScene.screensManager.restart()}))}})}))}onUndoClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Results:Undo"}),this.hide().then((()=>this.scene.events.emit(r.EventTypes.UNDO_LAST_MOVE)))}onCloseClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Results:ContinuePlaying"}),this.hide().then((()=>{this.gameplayScene.dataManager.finished=!1,this.gameplayScene.dataManager.victory=!1}))}destroy(e){this.scene.events.off(r.EventTypes.SHOW_DEFEAT_POPUP,this.show,this),super.destroy(e)}}t.DefeatPopup=u},6593:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractGameScreen=void 0;const a=i(s(2260)),n=s(9898);class o extends a.default.GameObjects.Container{constructor(e,t){super(e.gameplayScene),this.screensManager=e,this.gameplayScene=e.gameplayScene,this.config=t,this.build(),this.hide()}show(){this.setVisible(!0),this.doResize(this.gameplayScene.viewportWidth,this.gameplayScene.viewportHeight),this.showComponents()}hide(){this.setVisible(!1),this.hideComponents()}showComponents(){}hideComponents(){}doResize(e,t){e/t<=n.GameConfig.MAX_PORTRAIT_SCREEN_RATIO?this.resizePortrait(e,t):this.resizeLandscape(e,t)}resizeLandscape(e,t){this.resizePortrait(e,t)}makeResponsive(e,t){this.gameplayScene.makeResponsive(e,t)}destroy(e){super.destroy(e)}}t.AbstractGameScreen=o},59:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Screen_Gameplay=void 0;const i=s(6593),a=s(6666),n=s(9529),o=s(5870),r=s(929),d=s(2921),h=s(1066);class c extends i.AbstractGameScreen{constructor(e,t){super(e,Object.assign({screenName:"Gameplay"},t))}build(){this.gameplayScene.dataManager.resetGame(),this.gameplayScene.backgroundController.switchToGameplayBackground(),this.guiPanel=this.scene.add.existing(new a.GUIPanel(this.gameplayScene)),this.add(this.guiPanel),this.gamePanel=this.scene.add.existing(new n.GamePanel(this.gameplayScene)),this.add(this.gamePanel),this.confettiSpawner=this.scene.add.existing(new d.ConfettiSpawner(this.scene)),this.add(this.confettiSpawner),this.gameplayScene.makeResponsive(this.confettiSpawner,{y:-.5}),this.scene.events.on(h.EventTypes.SPAWN_CONFETTI,this.spawnConfetti,this),this.defeatPopup=this.scene.add.existing(new o.DefeatPopup(this.gameplayScene)),this.add(this.defeatPopup)}showComponents(){super.showComponents(),this.startGameplay()}startGameplay(){this.gameplayScene.dataManager.registerMatchStart(),window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Progression",progressionStatus:"Start",progression01:this.gameplayScene.dataManager.wasteMode===r.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"})}spawnConfetti(){this.confettiSpawner.show(4500)}resizePortrait(e,t){const s=185;this.guiPanel.setPosition(0,-t/2+92.5),this.guiPanel.resizePortrait(e,s),this.gamePanel.setPosition(0,92.5),this.gamePanel.resizePortrait(e,t-s),this.defeatPopup.setPosition(0,0),this.defeatPopup.resizePortrait(e,t)}resizeLandscape(e,t){const s=200*Phaser.Math.Clamp(e/t,1.5,3);this.guiPanel.setPosition(-e/2+s/2,0),this.guiPanel.resizeLandscape(s,t),this.gamePanel.setPosition(s/2,0),this.gamePanel.resizeLandscape(e-s,t),this.defeatPopup.setPosition(0,0),this.defeatPopup.resizeLandscape(e,t)}preUpdate(e,t){var s;null===(s=this.confettiSpawner)||void 0===s||s.updateEffect(t)}destroy(e){this.scene.events.off(h.EventTypes.SPAWN_CONFETTI,this.spawnConfetti,this),this.confettiSpawner.hide(0),super.destroy(e)}}t.Screen_Gameplay=c},1183:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Screen_MainMenu=void 0;const i=s(6593),a=s(5934),n=s(59),o=s(6615),r=s(929);class d extends i.AbstractGameScreen{constructor(e,t){super(e,Object.assign({screenName:"MainMenu"},t))}build(){this.gameplayScene.backgroundController.switchToMenuBackground(),this.logo=this.scene.add.image(0,0,"assets","logo"),this.add(this.logo),this.makeResponsive(this.logo,{y:-.15,dy:-100,scale:1,landscape:{y:-.15,dy:-100,scale:1.75}}),this.buttonsContainer=this.scene.add.container(),this.add(this.buttonsContainer),this.makeResponsive(this.buttonsContainer,{y:.15,dy:-25,scale:1,landscape:{y:.15,dy:-25,scale:1}}),this.statisticsContainer=this.scene.add.container(),this.buttonsContainer.add(this.statisticsContainer),this.makeResponsive(this.statisticsContainer,{dx:0,dy:165,scale:1.25,landscape:{dx:-225,dy:0,scale:1.8}}),this.buttonStatistics=this.scene.add.existing(new a.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-stats",clickCallback:()=>this.onStatisticsClicked()})),this.statisticsContainer.add(this.buttonStatistics),this.playContainer=this.scene.add.container(),this.buttonsContainer.add(this.playContainer),this.makeResponsive(this.playContainer,{dx:0,dy:-165,scale:1.5,landscape:{dx:225,dy:0,scale:2}}),this.buttonPlay=this.scene.add.existing(new a.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-play",clickCallback:()=>this.onPlayClicked()})),this.playContainer.add(this.buttonPlay)}resizePortrait(e,t){}preUpdate(e,t){}onStatisticsClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:MainMenu:Statistics"}),this.screensManager.transitionTo(o.Screen_Statistics)}onPlayClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:MainMenu:Play"}),window.famobi_analytics.trackEvent("EVENT_LEVELSTART",{levelName:this.gameplayScene.dataManager.wasteMode===r.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}).then((()=>{window.famobi.showInterstitialAd({eventId:"Button:MainMenu:Play",callback:()=>{this.screensManager.transitionTo(n.Screen_Gameplay)}})}))}}t.Screen_MainMenu=d},6615:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Screen_Statistics=void 0;const i=s(6593),a=s(5934),n=s(1183),o=s(8891),r=s(9898),d=s(929),h=s(272),c=s(59);class l extends i.AbstractGameScreen{constructor(e,t){console.error("Starting statistics screen ",t),super(e,Object.assign({screenName:"Statistics"},t))}build(){var e,t;this.gameplayScene.backgroundController.switchToMenuBackground(),this.tableContainer=this.scene.add.container(),this.add(this.tableContainer),this.makeResponsive(this.tableContainer,{x:0,y:-.05,dx:0,dy:-50,landscape:{x:0,y:-.05,dx:0,dy:-75}}),this.tableImage=this.scene.add.image(0,0,"table"),this.tableContainer.add(this.tableImage),this.textHeading=this.addTableText(0,-255,o.LocalizationManager.getInstance().getText("statistics"),"center"),this.text1Card=this.addTableText(60,-175,o.LocalizationManager.getInstance().getText("card1"),"center"),this.text3Cards=this.addTableText(260,-175,o.LocalizationManager.getInstance().getText("card3"),"center"),this.textGamesWon=this.addTableText(-200,-115,o.LocalizationManager.getInstance().getText("games_won"),"center"),this.textGamesWon1=this.addTableText(60,-115,`${this.gameplayScene.dataManager.getVictories(d.WasteMode.SINGLE_CARD)}`,"center"),this.textGamesWon3=this.addTableText(260,-115,`${this.gameplayScene.dataManager.getVictories(d.WasteMode.TRIPLE_CARD)}`,"center"),this.textGamesPlayed=this.addTableText(-200,-43,o.LocalizationManager.getInstance().getText("games_played"),"center"),this.textGamesPlayed1=this.addTableText(60,-43,`${this.gameplayScene.dataManager.getTotalMatches(d.WasteMode.SINGLE_CARD)}`,"center"),this.textGamesPlayed3=this.addTableText(260,-43,`${this.gameplayScene.dataManager.getTotalMatches(d.WasteMode.TRIPLE_CARD)}`,"center"),this.textBestScore=this.addTableText(-200,29,o.LocalizationManager.getInstance().getText("best_score"),"center"),this.textBestScore1=this.addTableText(60,29,`${this.gameplayScene.dataManager.getBestScore(d.WasteMode.SINGLE_CARD)}`,"center"),this.textBestScore3=this.addTableText(260,29,`${this.gameplayScene.dataManager.getBestScore(d.WasteMode.TRIPLE_CARD)}`,"center"),this.textLeastMoves=this.addTableText(-200,101,o.LocalizationManager.getInstance().getText("least_moves"),"center"),this.textLeastMoves1=this.addTableText(60,101,`${null!==(e=this.gameplayScene.dataManager.getLeastMoves(d.WasteMode.SINGLE_CARD))&&void 0!==e?e:"-"}`,"center"),this.textLeastMoves3=this.addTableText(260,101,`${null!==(t=this.gameplayScene.dataManager.getLeastMoves(d.WasteMode.TRIPLE_CARD))&&void 0!==t?t:"-"}`,"center"),this.textBestTime=this.addTableText(-200,173,o.LocalizationManager.getInstance().getText("best_time"),"center"),this.textBestTime1=this.addTableText(60,173,`${h.Utils.humanizeTime(this.gameplayScene.dataManager.getBestTime(d.WasteMode.SINGLE_CARD))}`,"center"),this.textBestTime3=this.addTableText(260,173,`${h.Utils.humanizeTime(this.gameplayScene.dataManager.getBestTime(d.WasteMode.TRIPLE_CARD))}`,"center"),this.textTotalTime=this.addTableText(-200,245,o.LocalizationManager.getInstance().getText("total_time"),"center"),this.textTotalTime1=this.addTableText(60,245,`${h.Utils.humanizeTime(this.gameplayScene.dataManager.getTotalTime(d.WasteMode.SINGLE_CARD))}`,"center"),this.textTotalTime3=this.addTableText(260,245,`${h.Utils.humanizeTime(this.gameplayScene.dataManager.getTotalTime(d.WasteMode.TRIPLE_CARD))}`,"center"),this.buttonContainer=this.scene.add.container(),this.add(this.buttonContainer),this.makeResponsive(this.buttonContainer,{x:0,y:.45,dx:0,dy:-150,scale:1.25,landscape:{x:0,y:.45,dx:0,dy:-125,scale:1.5}}),this.config.fromResults?(this.buttonRestart=this.scene.add.existing(new a.BasicButton({scene:this.gameplayScene,texture:"assets",scale:1.5,frame:"button-restart",clickCallback:()=>this.onRestartClicked()})),this.buttonContainer.add(this.buttonRestart)):(this.buttonBack=this.scene.add.existing(new a.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-continue",clickCallback:()=>this.onBackClicked()})),this.buttonBack.angle=-180,this.buttonContainer.add(this.buttonBack))}addTableText(e,t,s,i){const a=this.scene.add.text(e,t,s,{fontFamily:r.GameConfig.FONTS.MAIN,fontSize:"32px",color:"#ffffff",align:i,wordWrap:{useAdvancedWrap:!0,width:320},lineSpacing:-10});return a.setOrigin("center"===i?.5:0),this.tableContainer.add(a),a}resizePortrait(e,t){this.tableContainer.setScale(Math.min(.85*e/this.tableImage.width,.7*t/this.tableImage.height))}preUpdate(e,t){}onBackClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Statistics:BackToMainMenu"}),this.screensManager.transitionTo(n.Screen_MainMenu)}onRestartClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Results:Restart"}),window.famobi_analytics.trackEvent("EVENT_LEVELRESTART",{levelName:this.gameplayScene.dataManager.wasteMode===d.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}).then((()=>{window.famobi.showInterstitialAd({eventId:"Button:Results:Restart",callback:()=>{this.gameplayScene.screensManager.transitionTo(c.Screen_Gameplay,{callback:()=>{this.gameplayScene.uiController.hideAll(),this.gameplayScene.dataManager.resetGame()}})}})}))}}t.Screen_Statistics=l},8459:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function r(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CardsService=void 0;const a=s(9371),n=s(8628),o=s(2283),r=s(9898),d=s(4353),h=s(4340),c=s(1066),l=s(9793),u=s(6745),g=s(1438);t.CardsService=class{constructor(e){this.desk=e,this.gameplayScene=e.gameplayScene,this._delayedCalls=[],this._movesHistory=[],this.ghostAnimations=[],this.cardsMovedFromWasteSinceLastReset=0,this.wasteResetTimes=0,this.movesSinceLastDefeat=r.GameConfig.DEFEAT_POPUP_COOLDOWN_IN_MOVES,this.addEventListeners()}addEventListeners(){this.gameplayScene.events.on(c.EventTypes.SHOW_HINT,this.showHint,this),this.gameplayScene.events.on(c.EventTypes.USER_INTERACTED,this.onUserInteracted,this)}generateShuffledDeck(){const e=[],t=[a.CardSuit.DIAMONDS,a.CardSuit.SPADES,a.CardSuit.CLUBS,a.CardSuit.HEARTS],s=[n.CardRank.ACE,n.CardRank.RANK_2,n.CardRank.RANK_3,n.CardRank.RANK_4,n.CardRank.RANK_5,n.CardRank.RANK_6,n.CardRank.RANK_7,n.CardRank.RANK_8,n.CardRank.RANK_9,n.CardRank.RANK_10,n.CardRank.JACK,n.CardRank.QUEEN,n.CardRank.KING];for(let i=0;i<s.length;i++)for(let a=0;a<t.length;a++)e.push({rank:s[i],suit:t[a]});return Phaser.Utils.Array.Shuffle(e),e}calculateMoveScores(e,t){if(t&&e.zeroScore)return 0;if(e.sourcePile===this.desk.waste&&-1!==this.desk.tableau.indexOf(e.targetPile))return 5;if(e.sourcePile===this.desk.waste&&-1!==this.desk.foundations.indexOf(e.targetPile))return 10;if(-1!==this.desk.tableau.indexOf(e.sourcePile)&&-1!==this.desk.tableau.indexOf(e.targetPile))return 5;if(-1!==this.desk.tableau.indexOf(e.sourcePile)&&-1!==this.desk.foundations.indexOf(e.targetPile))return 10;if(t){if(-1!==this.desk.foundations.indexOf(e.sourcePile)&&-1!==this.desk.tableau.indexOf(e.targetPile))return 10;if(-1!==this.desk.foundations.indexOf(e.sourcePile)&&e.targetPile===this.desk.waste)return 10}else if(-1!==this.desk.foundations.indexOf(e.sourcePile)&&-1!==this.desk.tableau.indexOf(e.targetPile))return-15;return 0}registerMove(e){e.score=e.zeroScore?0:this.calculateMoveScores(e),this._movesHistory.push(e),this.gameplayScene.dataManager.score+=e.score,this.gameplayScene.dataManager.moves+=1,this.movesSinceLastDefeat-=1}isUndoPossible(){return this._movesHistory.length>0}getLastMove(){return this._movesHistory[this._movesHistory.length-1]}revertLastMove(){return this._movesHistory.splice(this._movesHistory.length-1,1)[0]}dealCards(){return i(this,void 0,void 0,(function*(){const e=[],t=r.GameConfig.INITIAL_DEAL_DELAY_BETWEEN_CARDS;let s=0;if(this.gameplayScene.dataManager.handMode===h.HandMode.RIGHT_HAND){for(let e=4;e>-1;e--)this.desk.tableau[e].parentContainer.bringToTop(this.desk.tableau[e]);this.desk.tableau[5].parentContainer.bringToTop(this.desk.tableau[5]),this.desk.tableau[6].parentContainer.bringToTop(this.desk.tableau[6])}else for(let e=0;e<7;e++)this.desk.tableau[e].parentContainer.bringToTop(this.desk.tableau[e]);for(let i=0;i<7;i++)for(let a=i;a<7;a++){const n=this.desk.tableau[a],d=new Promise(((e,d)=>{const h=this.gameplayScene.time.delayedCall(s*t,(()=>{const t=this.desk.stock.getTopCard();t&&(t.setFlipStatus(i===a?o.FlipStatus.FRONT:o.FlipStatus.BACK),this.desk.moveCardToPile(t,n,r.GameConfig.CARD_ANIMATION_SPEED.DEAL,0,!0).then((()=>e())))}));this._delayedCalls.push(h)}));e.push(d),s+=1}this._delayedCalls.push(this.gameplayScene.time.delayedCall(s*t,(()=>{d.SoundManager.instance.play("new_game",1,110)})));const i=this.desk.stock.resetCardsToTheirInitialPosition((s+1)*t,.25*t);yield Promise.all([...e,...i])}))}resetWaste(){return i(this,void 0,void 0,(function*(){const e=[],t=this.desk.waste.getCards();t.length>0&&d.SoundManager.instance.play("new_game",1,110),this.registerMove({cards:t,sourcePile:this.desk.waste,targetPile:this.desk.stock}),this.gameplayScene.dataManager.score-=15,this.desk.waste.resetBottomCardsPositions(0,!1);for(let s=t.length-1;s>-1;s--){const i=t[s];i.isFaceUp()&&i.flipToBack(),e.push(this.desk.moveCardToPile(i,this.desk.stock,r.GameConfig.CARD_ANIMATION_SPEED.WASTE_TO_STOCK,22.5*(s+1),!1))}yield Promise.all([...e]),this.cardsMovedFromWasteSinceLastReset=0,this.wasteResetTimes+=1,this.gameplayScene.events.emit(c.EventTypes.USER_MOVE_FINISHED)}))}areAllCardsOpened(){return this.desk.stock.isEmpty()&&this.desk.waste.isEmpty()&&this.desk.tableau.every((e=>e.getCards().every((e=>e.isFaceUp()))))}autoSolve(){return new Promise(((e,t)=>i(this,void 0,void 0,(function*(){const t=e=>new Promise(((t,s)=>{let i=this.getTableauTopCards();if(0===i.length)t(!1);else{let s=!1;for(let a of i){const i=this.desk.findFoundationPileFor(a);if(i){this.gameplayScene.time.delayedCall(e,(()=>{this.desk.autoDropCardTo(a,i,0),t(!0)})),s=!0;break}}s||t(!1)}}));let s=!0;do{s=yield t(r.GameConfig.AUTOSOLVE_ANIMATION_DELAY_BETWEEN_CARDS)}while(s);e()}))))}checkDefeat(){this.hasPossibleMovesFromFoundations();const e=this.hasPossibleMovesInTableau(),t=this.hasPossibleMovesFromStock();return!(this.hasPossibleMovesFromWaste()||e||t)}onUserInteracted(e){this.removeGhostAnimations(),this.desk.stock.resetHighlighting(),this.desk.waste.resetHighlighting(),this.desk.tableau.forEach((e=>e.resetHighlighting())),this.desk.foundations.forEach((e=>e.resetHighlighting()))}getRandomPossibleMove(){const e=[],t=this.getPossibleMovesInTableau(!1);t.length>0&&e.push(...t);const s=this.getPossibleMovesFromWaste(!1);if(s.length>0&&e.push(...s),e.length>0){e.sort(((e,t)=>{var s,i;return(null!==(s=t.movePriority)&&void 0!==s?s:0)-(null!==(i=e.movePriority)&&void 0!==i?i:0)}));const t=e[0].movePriority;return Phaser.Utils.Array.GetRandom(e.filter((e=>e.movePriority===t)))}}getRandomDumbMove(){const e=[],t=this.getPossibleMovesFromFoundations(!1);if(t.length>0&&e.push(...t),e.length>0){e.sort(((e,t)=>{var s,i;return(null!==(s=t.movePriority)&&void 0!==s?s:0)-(null!==(i=e.movePriority)&&void 0!==i?i:0)}));const t=e[0].movePriority;return Phaser.Utils.Array.GetRandom(e.filter((e=>e.movePriority===t)))}}autoMove(){var e;console.log(">autoplay...");const t=this.getRandomPossibleMove();if(!t)return console.log("autoplay: no moves"),void(this.desk.stock.isEmpty()?this.cardsMovedFromWasteSinceLastReset>0?this.resetWaste().then((()=>{this.gameplayScene.time.delayedCall(1250,(()=>{this.autoMove()}))})):console.log(">autoplay: finished"):(this.desk.stock.dispatchCardClick(this.desk.stock.getTopCard()),this.gameplayScene.time.delayedCall(1e3,(()=>{this.autoMove()}))));if(t.cards[0].getPile()instanceof l.TableauPile){let s=t.cards[0],i=[];do{i.push(s);const a=null===(e=s.getPile())||void 0===e?void 0:e.getNextCard(s);this.desk.moveCardToPile(s,t.targetPile,r.GameConfig.CARD_ANIMATION_SPEED.FLY_TO_FOUNDATION,0,!0,!0).then((()=>{})),s=a}while(s);this.desk.cardsService.registerMove({cards:i,sourcePile:t.sourcePile,targetPile:t.targetPile,zeroScore:t.zeroScore}),this.gameplayScene.time.delayedCall(1e3,(()=>{this.autoMove()}))}else this.desk.moveCardToPile(t.cards[0],t.targetPile,r.GameConfig.CARD_ANIMATION_SPEED.FLY_TO_FOUNDATION,0,!0,!0).then((()=>{this.gameplayScene.time.delayedCall(750,(()=>{this.autoMove()}))})),this.desk.cardsService.registerMove(t)}showHint(){var e;const t=this.getRandomPossibleMove();if(!t){return void(this.getPossibleMovesFromStock(!1).length>0?this.desk.stock.highlight(r.GameConfig.HINT_ANIMATIONS_REPEATS):this.gameplayScene.events.emit(c.EventTypes.HINT_UNAVAILABLE,!1))}let s=t.cards[0];const i=t.targetPile;let a=0;do{this.playGhostCardMoveAnimation(s,i,a),s=null===(e=s.getPile())||void 0===e?void 0:e.getNextCard(s),a+=r.GameConfig.CARD_PILE_OFFSET_Y.FACE_UP}while(s);this.gameplayScene.events.emit(c.EventTypes.HINT_SUCCESSFUL)}playGhostCardMoveAnimation(e,t,s){const i=e.getPile();if(!i)return;const a=this.gameplayScene.add.existing(new u.GhostCard(e));this.desk.add(a),a.setPosition(i.x+e.pileOffsetX,i.y+e.pileOffsetY),a.launch(i.x+e.pileOffsetX,i.y+e.pileOffsetY,t,s,r.GameConfig.HINT_ANIMATIONS_REPEATS),this.ghostAnimations.push(a)}removeGhostAnimations(){for(let e=this.ghostAnimations.length-1;e>-1;e--){const t=this.ghostAnimations[e];this.ghostAnimations.splice(e,1),t.destroy()}}getPossibleMovesInTableau(e){let t=[];for(let s of this.desk.tableau){const i=s.getTopCard();if(i)for(let s of this.desk.foundations)if(s.cardAllowedToBeDropped(i)&&(t.push({cards:[i],sourcePile:i.getPile(),targetPile:s,movePriority:g.MovePriority.TABLEAU_TO_FOUNDATION}),e))return t;const a=s.getFirstOpenedCard();if(a){const i=!!s.getPrevCard(a);if(s.getPrevCard(a)){for(let n of this.desk.tableau)if(n!==s&&n.cardAllowedToBeDropped(a)&&!this.isRevertedMove(a,n)&&(t.push({cards:[a],sourcePile:a.getPile(),targetPile:n,movePriority:i?g.MovePriority.TABLEAU_TO_TABLEAU_UNCOVER:g.MovePriority.TABLEAU_TO_TABLEAU_REGULAR}),e))return t}else if(a.rank!==n.CardRank.KING)for(let n of this.desk.tableau)if(n!==s&&n.cardAllowedToBeDropped(a)&&!this.isRevertedMove(a,n)&&(t.push({cards:[a],sourcePile:a.getPile(),targetPile:n,movePriority:i?g.MovePriority.TABLEAU_TO_TABLEAU_UNCOVER:g.MovePriority.TABLEAU_TO_TABLEAU_REGULAR}),e))return t}}return t}getPossibleMovesFromWaste(e){let t=[];const s=this.desk.waste.getTopCard();if(s){for(let i of this.desk.foundations)if(i.cardAllowedToBeDropped(s)&&(t.push({cards:[s],sourcePile:s.getPile(),targetPile:i,movePriority:g.MovePriority.WASTE_TO_FOUNDATION}),e))return t;for(let i of this.desk.tableau)if(i.cardAllowedToBeDropped(s)&&(t.push({cards:[s],sourcePile:s.getPile(),targetPile:i,movePriority:g.MovePriority.WASTE_TO_TABLEAU}),e))return t}return t}getPossibleMovesFromStock(e){let t=[];const s=[...this.desk.stock.getExtractableCards([]),...this.desk.stock.getExtractableCards(this.desk.waste.getCards())];if(0===s.length)return t;for(let i of s){for(let s of this.desk.foundations)if(s.cardAllowedToBeDropped(i,!0)&&(t.push({cards:[i],sourcePile:i.getPile(),targetPile:s,movePriority:g.MovePriority.STOCK_TO_WASTE}),e))return t;for(let s of this.desk.tableau)if(s.cardAllowedToBeDropped(i)&&(t.push({cards:[i],sourcePile:i.getPile(),targetPile:s,movePriority:g.MovePriority.STOCK_TO_WASTE}),e))return t}return t}getPossibleMovesFromFoundations(e){let t=[];for(let s of this.desk.foundations){const i=s.getTopCard();if(i&&i.rank>n.CardRank.RANK_2)for(let s of this.desk.tableau)if(s.cardAllowedToBeDropped(i)&&!this.isRevertedMove(i,s)&&(t.push({cards:[i],sourcePile:i.getPile(),targetPile:s,movePriority:g.MovePriority.FOUNDATION_TO_TABLEAU}),e))return t}return t}hasPossibleMovesFromFoundations(){return this.getPossibleMovesFromFoundations(!0).length>0}hasPossibleMovesFromStock(){return this.getPossibleMovesFromStock(!0).length>0}hasPossibleMovesFromWaste(){return this.getPossibleMovesFromWaste(!0).length>0}hasPossibleMovesInTableau(){return this.getPossibleMovesInTableau(!0).length>0}isRevertedMove(e,t){const s=this.getLastMove();if(!s)return!1;if(s.cards[0]===e){if(s.targetPile===e.getPile()&&s.sourcePile===t)return!0;if(this.desk.foundations.includes(s.targetPile))return!0}return!1}getTableauTopCards(){return this.desk.tableau.map((e=>e.getTopCard())).filter((e=>void 0!==e))}restart(){this._movesHistory=[],this.cardsMovedFromWasteSinceLastReset=0,this.movesSinceLastDefeat=0;for(let e=this._delayedCalls.length-1;e>-1;e--){this._delayedCalls[e].destroy()}}destroy(){this.gameplayScene.events.off(c.EventTypes.USER_INTERACTED,this.onUserInteracted,this),this.gameplayScene.events.off(c.EventTypes.SHOW_HINT,this.showHint,this),this.restart()}}},8891:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function r(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizationManager=void 0;const a=s(9898);class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}constructor(){this.activeLocale="en-US"}loadLocalizationFile(e){return i(this,void 0,void 0,(function*(){const t=yield fetch(e).then((e=>e.json()));this.init(t)}))}setLocale(e){this.activeLocale=this.findAvailableLocale(e),this.activeTranslationData=this.translations.get(this.activeLocale),this.activeTranslationData||(this.activeTranslationData=this.translations.get(this.getLang(this.activeLocale)))}getText(e){return a.GameConfig.ENABLE_LOCALIZATION?this.activeTranslationData?this.activeTranslationData[e]?this.activeTranslationData[e]:(console.warn('LocalizationManager.getText: no translation for key "'+e+'"'),"---"+e):(console.warn("LocalizationManager.getText: localization data not loaded yet"),e):(console.error("Set GameConfig.ENABLE_LOCALIZATION to true before using localized texts!"),e)}getLocalesData(){return Array.from(this.translations.entries())}getActiveLocale(){return this.activeLocale}init(e){this.translations=new Map;for(let t in e)this.translations.set(t,e[t]),famobi.log("loaded localization: "+t);const t=famobi.getCurrentLanguage(),s=this.getClientLanguage();this.setLocale(t||s)}findAvailableLocale(e){if(this.translations.has(e))return e;const t=this.getLang(e);return this._findFallbackLocale(e,t)}getLang(e){const t=e.indexOf("-");return-1!==t?e.substring(0,t):e}_findFallbackLocale(e,t){let s=n.DEFAULT_LOCALE_FALLBACKS[e];if(s&&this.translations[s])return s;if(s=n.DEFAULT_LOCALE_FALLBACKS[t],s&&this.translations[s])return s;for(let e of this.translations){const s=e[0];if(t===this.getLang(s))return s}return n.DEFAULT_LOCALE}getClientLanguage(){return navigator.language||"en-US"}}n.DEFAULT_LOCALE="en-US",n.DEFAULT_LOCALE_FALLBACKS={en:"en-US",es:"en-ES",zh:"zh-CN","zh-HK":"zh-TW","zh-TW":"zh-HK","zh-MO":"zh-HK",fr:"fr-FR",de:"de-DE",it:"it-IT",ru:"ru-RU",ja:"ja-JP"},t.LocalizationManager=n},8537:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(2260)),n=i(s(6756)),o=i(s(1475)),r=i(s(2906)),d=s(9898),h=s(8314),c=s(578),l=s(8891),u=s(8240),g=s(2728);const p=()=>{(0,u.initFamobiMockObject)(),g.FamobiAPI.addFamobiHandlers();const e={type:a.default.WEBGL,transparent:!0,parent:"game-container",fullscreenTarget:"game-container",scale:{mode:a.default.Scale.ScaleModes.NONE},scene:[o.default,r.default],input:{activePointers:1}},t=[];if(d.GameConfig.ENABLE_LOCALIZATION){const e=l.LocalizationManager.getInstance().loadLocalizationFile("assets/localization/localization.json");t.push(e)}const s=h.FontsLoader.loadFonts(...Object.values(d.GameConfig.FONTS));t.push(s),Promise.all(t).then((()=>{window.game=new n.default(e)})),c.ResizeController.getInstance().init()};"undefined"!=typeof famobi?p():window.addEventListener("load",(()=>{p()}))},8314:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function o(e){try{d(i.next(e))}catch(e){n(e)}}function r(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FontsLoader=void 0;const n=a(s(5933));t.FontsLoader=class{static loadFonts(...e){return i(this,void 0,void 0,(function*(){if(!e||0===e.length)return Promise.resolve("No fonts");n.default.load({custom:{families:e},active:()=>Promise.resolve("Loaded"),inactive:()=>Promise.resolve("Inactive")})}))}}},578:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeController=void 0;const a=s(9898),n=i(s(6756));class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}constructor(){}init(){window.addEventListener("resize",(()=>this.doResize())),setTimeout((()=>this.doResize()),100)}doResize(){var e;(null===(e=n.default.instance)||void 0===e?void 0:e.currentScene)&&(this._resizeCanvas(),setTimeout((()=>this._resizeCanvas()),250),(navigator.userAgent.includes("iPad")||navigator.userAgent.includes("iPhone"))&&setTimeout((()=>this._resizeCanvas()),500))}_resizeCanvas(){var e,t,s;const i=null===(e=n.default.instance)||void 0===e?void 0:e.scale.canvas,o=famobi.getOffsets(),r=window.innerWidth-o.left-o.right,d=window.innerHeight-o.top-o.bottom,h=Math.min(window.devicePixelRatio||1,3);let c=Math.floor(r*h),l=Math.floor(d*h);if(Math.max(c,l)>a.GameConfig._MAX_RENDERER_WIDTH){const e=a.GameConfig._MAX_RENDERER_WIDTH/Math.max(c,l);c=Math.floor(e*c),l=Math.floor(e*l)}null===(s=null===(t=n.default.instance)||void 0===t?void 0:t.currentScene)||void 0===s||s.scale.resize(c,l),i.style.left=o.left+"px",i.style.right=o.right+"px",i.style.top=o.top+"px",i.style.bottom=o.bottom+"px",i.style.width=r+"px",i.style.height=d+"px"}forceResize(){this.doResize()}}t.ResizeController=o},2301:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(2260)),n=s(9898),o=i(s(6756)),r=s(2149);class d extends a.default.Scene{constructor(e){super(e),this.autoResizeableElements=[],window.scene=o.default.instance.currentScene=this}preload(){this.scale.on("resize",this.onResize,this),this.events.on("postupdate",this.postUpdate,this),this.events.on("shutdown",this.onShutdown,this)}update(e,t){super.update(e,t)}doResize(e,t){var s;this.cameras&&this.cameras.main&&(this.resizeCamera(e,t),null===(s=this.autoResizeableElements)||void 0===s||s.forEach((e=>{e&&e.__responsivePositionData&&this._resizeElement(e,this.viewportWidth,this.viewportHeight)})),this.handleResize(this.viewportWidth,this.viewportHeight))}onResize(e){this.doResize(e.width,e.height)}resizeCamera(e,t){this.cameras.resize(e,t),this.cameras.main.setZoom(Math.min(e/n.GameConfig.getWidth(),t/n.GameConfig.getHeight()))}_resizeElement(e,t,s){const i=this.isLandscapeOrientation()&&e.__responsivePositionData.landscape||e.__responsivePositionData,a=i.x||0,n=i.y||0,o=i.dx||0,r=i.dy||0;e.setPosition(a*t+o,n*s+r),void 0!==i.scale&&e.setScale(i.scale)}postUpdate(e,t){}get viewportHeight(){return this.cameras.main.height/this.cameras.main.zoom}get viewportWidth(){return this.cameras.main.width/this.cameras.main.zoom}isPortraitOrientation(){return this.cameras.main.width/this.cameras.main.height<=n.GameConfig.MAX_PORTRAIT_SCREEN_RATIO}isLandscapeOrientation(){return!this.isPortraitOrientation()}makeResponsive(e,t,s=!0){e instanceof Array||(e=[e]),e.forEach((e=>{var i;e.__responsivePositionData=t?r.ResponsivePositionData.clone(t):new r.ResponsivePositionData,null===(i=this.autoResizeableElements)||void 0===i||i.push(e),s&&this._resizeElement(e,this.viewportWidth,this.viewportHeight)}))}onShutdown(){delete this.autoResizeableElements,this.scale.off("resize",this.onResize,this),this.events.off("postupdate",this.postUpdate,this),this.events.off("destroy",this.onShutdown,this)}}t.default=d},2906:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(9898),n=s(3825),o=s(2688),r=s(6602),d=i(s(2301)),h=s(6512),c=s(5420),l=s(3408),u=s(578),g=s(4191);class p extends d.default{constructor(){super(n.Scenes.GAMEPLAY),this.dataManager=new l.GameDataManager(this)}create(){this.addEventListeners(),this.createElements(),u.ResizeController.getInstance().forceResize(),this.overlayScreen.transition({callback:()=>{this.dataManager.loadSavedValues(),this.dataManager.resetGame(),this.screensManager.start()},skipFadeIn:!0})}update(e,t){super.update(e,t),this.dataManager.update(t/1e3)}handleResize(e,t){this.backgroundController.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.screensManager.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.uiController.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.foregroundController.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.overlayScreen.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.backgroundController.resize(e,t),this.screensManager.resize(e,t),this.foregroundController.resize(e,t),this.uiController.resize(e,t),this.overlayScreen.resize(e,t)}getActiveScreen(){return this.screensManager.getActiveScreen()}addEventListeners(){a.GameConfig.debug.cheats&&alert("cheats enabled!")}createElements(){this.backgroundController=new h.BackgroundController(this),this.backgroundController.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.add.existing(this.backgroundController),this.screensManager=new c.ScreensManager(this),this.screensManager.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.add.existing(this.screensManager),this.uiController=new o.UIController(this),this.uiController.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.add.existing(this.uiController),this.foregroundController=new g.ForegroundController(this),this.foregroundController.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.add.existing(this.foregroundController),this.overlayScreen=new r.OverlayScreen(this),this.overlayScreen.setPosition(this.cameras.main.centerX,this.cameras.main.centerY),this.add.existing(this.overlayScreen)}}t.default=p},1475:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(s(2260)),n=s(3825),o=i(s(2301)),r=s(272),d=s(4353),h=s(9898);var c=a.default.Sound.WebAudioSoundManager;class l extends o.default{constructor(){super(n.Scenes.PRELOAD)}handleResize(e,t){}preload(){super.preload(),this.load.json("config","assets/config.json")}create(){if(this.load.image("white-square","assets/img/white-square.png"),this.load.image("background","assets/img/background.png"),this.load.image("tutorial1","assets/img/tutorial1.png"),this.load.image("tutorial2","assets/img/tutorial2.png"),this.load.image("table","assets/img/table.png"),this.load.image("famobi-logo","assets/img/famobi-logo.png"),this.load.image("famobi-banner",window.famobi.getBrandingButtonImage()),this.load.multiatlas("particles","assets/img/particles.json","assets/img"),this.load.multiatlas("assets","assets/img/assets.json","assets/img"),this.load.multiatlas("cards","assets/img/cards.json","assets/img"),h.GameConfig.CUSTOM_AUDIO_LOADING_LOGIC&&this.sound instanceof c){const e=[];for(let e of d.SoundManager.instance.getSoundNames())fetch("assets/audio/"+e+".mp3").then((e=>e.arrayBuffer())).then((t=>new Promise((s=>{this.sound.decodeAudio(e,t),s()})))),this.load.audio(e,"assets/audio/"+e+".mp3");Promise.all(e).then((()=>{d.SoundManager.instance.dispatchAudioReady()})).catch((e=>{console.warn("Could not load or decode one or multiple audio files")}))}else for(let e of d.SoundManager.instance.getSoundNames())this.load.audio(e,"assets/audio/"+e+".mp3");this.load.on(a.default.Loader.Events.COMPLETE,(()=>{d.SoundManager.instance.dispatchAudioReady(),r.Utils.setLoadingSpinnerVisible(!1),this.scene.start(n.Scenes.GAMEPLAY),window.famobi.gameReady()})),this.load.on(a.default.Loader.Events.PROGRESS,(e=>{window.famobi.setPreloadProgress(Math.floor(100*e)),r.Utils.setLoadingSpinnerProgress(e)})),this.load.start()}}t.default=l},1872:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsMenu=void 0;const a=s(9898),n=s(5934),o=i(s(2260)),r=s(1066),d=s(929),h=s(4340),c=s(1183),l=s(59),u=s(8891);class g extends o.default.GameObjects.Container{constructor(e){super(e),this.gameplayScene=e,this.buildComponents(),this.addEventListeners(),this.visible=!1,this._active=!1}addEventListeners(){this.scene.events.on(r.EventTypes.SOUND_STATE_CHANGED,this._updateSoundButtons,this),this.scene.events.on(r.EventTypes.WASTE_MODE_CHANGED,this._updateWasteModeButtons,this),this.scene.events.on(r.EventTypes.HAND_MODE_CHANGED,this._updateHandModeButtons,this)}removeEventListeners(){this.scene.events.off(r.EventTypes.SOUND_STATE_CHANGED,this._updateSoundButtons,this),this.scene.events.off(r.EventTypes.WASTE_MODE_CHANGED,this._updateWasteModeButtons,this),this.scene.events.off(r.EventTypes.HAND_MODE_CHANGED,this._updateHandModeButtons,this)}_updateSoundButtons(e){this.buttonSoundOn.visible=e,this.buttonSoundOff.visible=!e}_updateWasteModeButtons(e){this.buttonWasteModeSingle.visible=e===d.WasteMode.SINGLE_CARD,this.buttonWasteModeTriple.visible=e===d.WasteMode.TRIPLE_CARD}_updateHandModeButtons(e){this.buttonRightHanded.visible=e===h.HandMode.RIGHT_HAND,this.buttonLeftHanded.visible=e===h.HandMode.LEFT_HAND}buildComponents(){this.background=this.scene.add.image(0,0,"white-square"),this.background.setTint(35328,35328,16384,16384),this.add(this.background),this.background.setInteractive(),this.settingsIconContainer=this.scene.add.container(),this.add(this.settingsIconContainer),this.gameplayScene.makeResponsive(this.settingsIconContainer,{x:0,y:-.375,dy:-50,scale:1.5,landscape:{x:0,y:-.325,dy:-100,scale:1.75}}),this.settingsIcon=this.scene.add.image(0,0,"assets","icon-settings"),this.settingsIconContainer.add(this.settingsIcon),this.helpContainer=this.scene.add.container(),this.add(this.helpContainer),this.gameplayScene.makeResponsive(this.helpContainer,{x:0,y:-.375,dx:300,dy:-50,scale:1.5,landscape:{x:0,y:-.325,dx:620,dy:-100,scale:1.75}}),this.buttonHelp=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-tutorial",clickCallback:()=>this.onHelpClicked()})),this.helpContainer.add(this.buttonHelp),this.buttonsContainer=this.scene.add.container(),this.add(this.buttonsContainer),this.gameplayScene.makeResponsive(this.buttonsContainer,{x:0,y:.075,dx:0,dy:50,scale:1.75,landscape:{x:0,y:.05,dx:0,dy:0,scale:2.25}}),this.handContainer=this.scene.add.container(),this.buttonsContainer.add(this.handContainer),this.buttonLeftHanded=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-left-hand",clickCallback:()=>this.onLeftHandModeClicked()})),this.handContainer.add(this.buttonLeftHanded),this.buttonRightHanded=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-right-hand",clickCallback:()=>this.onRightHandModeClicked()})),this.handContainer.add(this.buttonRightHanded),this.wasteModeContainer=this.scene.add.container(),this.buttonsContainer.add(this.wasteModeContainer),this.buttonWasteModeSingle=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-waste-1-card",clickCallback:()=>this.onWasterModeSingleClicked()})),this.wasteModeContainer.add(this.buttonWasteModeSingle),this.buttonWasteModeTriple=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-waste-3-cards",clickCallback:()=>this.onWasterModeTripleClicked()})),this.wasteModeContainer.add(this.buttonWasteModeTriple),this.soundContainer=this.scene.add.container(),this.buttonsContainer.add(this.soundContainer),this.buttonSoundOff=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-sound-off",clickCallback:()=>this.onSoundOffClicked()})),this.soundContainer.add(this.buttonSoundOff),this.buttonSoundOn=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-sound-on",clickCallback:()=>this.onSoundOnClicked()})),this.soundContainer.add(this.buttonSoundOn),this.homeContainer=this.scene.add.container(),this.buttonsContainer.add(this.homeContainer),this.buttonHome=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-home",clickCallback:()=>this.onHomeClicked()})),this.homeContainer.add(this.buttonHome),this.restartContainer=this.scene.add.container(),this.buttonsContainer.add(this.restartContainer),this.buttonRestart=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-replay",clickCallback:()=>this.onRestartClicked()})),this.restartContainer.add(this.buttonRestart),this.continueContainer=this.scene.add.container(),this.buttonsContainer.add(this.continueContainer),this.buttonContinue=this.scene.add.existing(new n.BasicButton({scene:this.gameplayScene,texture:"assets",frame:"button-continue",clickCallback:()=>this.onContinueClicked()})),this.continueContainer.add(this.buttonContinue),window.famobi.hasFeature("external_mute")?(this.soundContainer.visible=!1,this.buttonsGrid=[this.handContainer,this.wasteModeContainer,this.homeContainer,this.restartContainer,this.continueContainer]):this.buttonsGrid=[this.handContainer,this.wasteModeContainer,this.soundContainer,this.homeContainer,this.restartContainer,this.continueContainer],this.banner=this.scene.add.image(0,0,"famobi-banner"),this.add(this.banner),this.gameplayScene.makeResponsive(this.banner,{x:0,y:.475,dy:-80,scale:.75,landscape:{x:0,y:.475,dy:-65,scale:.75}}),this.banner.setInteractive().on(o.default.Input.Events.POINTER_DOWN,(()=>{window.famobi.openBrandingLink()})),this.textGameWillRestart=this.scene.add.text(0,0,u.LocalizationManager.getInstance().getText("restart_warning"),{fontFamily:a.GameConfig.FONTS.MAIN,fontSize:"28px",color:"#ffffff",align:"center",wordWrap:{useAdvancedWrap:!0,width:960},lineSpacing:-4}),this.textGameWillRestart.setOrigin(.5),this.buttonsContainer.add(this.textGameWillRestart),this.textGameWillRestart.visible=!1,this._updateHandModeButtons(this.gameplayScene.dataManager.handMode),this._updateWasteModeButtons(this.gameplayScene.dataManager.wasteMode),this._updateSoundButtons(this.gameplayScene.dataManager.soundEnabled)}resize(e,t){this.background.setDisplaySize(e,t),e/t>a.GameConfig.MAX_PORTRAIT_SCREEN_RATIO?(this.buttonsGrid.forEach(((e,t)=>{e.setPosition(235*(t%3-1),200*(Math.floor(t/3)-.5))})),this.textGameWillRestart.setPosition(0,215)):(this.buttonsGrid.forEach(((e,t)=>{e.setPosition(275*(t%2-.5),205*(Math.floor(t/2)-1.5))})),this.textGameWillRestart.setPosition(0,215))}show(){this._active||(this._active=!0,this.visible=!0,this.gameplayScene.dataManager.paused=!0,this._lastWasteMode=this.gameplayScene.dataManager.wasteMode,this.background.alpha=0,this.scene.tweens.add({targets:this.background,alpha:1,duration:300,ease:o.default.Math.Easing.Sine.Out,onComplete:()=>{}}),this.settingsIcon.alpha=0,this.settingsIcon.y=-40,this.settingsIcon.scale=.75,this.settingsIcon.angle=-90,this.scene.tweens.add({targets:this.settingsIcon,alpha:1,y:0,scale:1,angle:0,duration:275,ease:o.default.Math.Easing.Sine.Out,onComplete:()=>{}}),this.buttonHelp.alpha=0,this.buttonHelp.x=40,this.scene.tweens.add({targets:this.buttonHelp,alpha:1,x:0,duration:225,delay:75,ease:o.default.Math.Easing.Sine.Out,onComplete:()=>{}}),this.buttonsGrid.forEach(((e,t)=>{e.setScale(.5),e.setAlpha(0),this.scene.tweens.add({targets:e,scale:1,alpha:1,ease:o.default.Math.Easing.Back.Out,duration:300,delay:25+55*t})})))}hide(){this._active&&(this._active=!1,this.visible=!1,this.gameplayScene.dataManager.paused=!1)}preUpdate(e,t){this.textGameWillRestart.visible=this.gameplayScene.dataManager.wasteMode!==this._lastWasteMode}onHelpClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:ShowTutorial"}),this.gameplayScene.uiController.showTutorialPopup()}onLeftHandModeClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:ToggleRightHandedMode"}),this.gameplayScene.dataManager.handMode=h.HandMode.RIGHT_HAND,this.gameplayScene.dataManager.saveData()}onRightHandModeClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:ToggleLeftHandedMode"}),this.gameplayScene.dataManager.handMode=h.HandMode.LEFT_HAND,this.gameplayScene.dataManager.saveData()}onWasterModeSingleClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:ToggleWasteMode3Cards"}),this.gameplayScene.dataManager.wasteMode=d.WasteMode.TRIPLE_CARD,this.gameplayScene.dataManager.saveData()}onWasterModeTripleClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:ToggleWasteMode1Card"}),this.gameplayScene.dataManager.wasteMode=d.WasteMode.SINGLE_CARD,this.gameplayScene.dataManager.saveData()}onSoundOnClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:ToggleSoundOff"}),this.gameplayScene.dataManager.soundEnabled=!1,this.gameplayScene.dataManager.saveData()}onSoundOffClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:ToggleSoundOn"}),this.gameplayScene.dataManager.soundEnabled=!0,this.gameplayScene.dataManager.saveData()}onHomeClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Progression",progressionStatus:"Fail",progression01:this.gameplayScene.dataManager.wasteMode===d.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}),window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:Quit"}),window.famobi_analytics.trackEvent("EVENT_LEVELFAIL",{levelName:this.gameplayScene.dataManager.wasteMode===d.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS",reason:"quit"}).then((()=>{window.famobi.showInterstitialAd({eventId:"Button:Pause:Quit",callback:()=>{this.gameplayScene.dataManager.saveData(),this.gameplayScene.screensManager.transitionTo(c.Screen_MainMenu,{callback:()=>{this.gameplayScene.uiController.hideAll()}})}})}))}onRestartClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:Restart"}),window.famobi_analytics.trackEvent("EVENT_LEVELRESTART",{levelName:this.gameplayScene.dataManager.wasteMode===d.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}).then((()=>{window.famobi.showInterstitialAd({eventId:"Button:Pause:Restart",callback:()=>{this._restartGame()}})}))}onContinueClicked(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Pause:Resume"}),window.famobi_analytics.trackEvent("EVENT_RESUME").then((()=>{this.gameplayScene.dataManager.wasteMode!==this._lastWasteMode?window.famobi_analytics.trackEvent("EVENT_LEVELRESTART",{levelName:this.gameplayScene.dataManager.wasteMode===d.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}).then((()=>{this._restartGame()})):this.hide()}))}_restartGame(){window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Progression",progressionStatus:"Fail",progression01:this.gameplayScene.dataManager.wasteMode===d.WasteMode.SINGLE_CARD?"1_CARD":"3_CARDS"}),this.gameplayScene.dataManager.saveData(),this.gameplayScene.screensManager.transitionTo(l.Screen_Gameplay,{callback:()=>{this.gameplayScene.uiController.hideAll(),this.gameplayScene.dataManager.resetGame()}})}destroy(e){this.removeEventListeners(),super.destroy(e)}}t.SettingsMenu=g},943:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TutorialPopup=void 0;const a=s(9898),n=s(5934),o=i(s(2260)),r=s(8891);class d extends o.default.GameObjects.Container{constructor(e){super(e),this.selectedProductKeyIndex=0,this._dragReady=!1,this.gameplayScene=e,this.buildComponents(),this.visible=!1,this._active=!1}buildComponents(){this.background=this.scene.add.image(0,0,"white-square"),this.background.setTint(24576,24576,16384,16384),this.add(this.background),this.background.setInteractive(),this._productKeys=["tutorial1","tutorial2"],this._textKeys=["tutorial1","tutorial2"],this.selectedProductKeyIndex=0,this.contentContainer=this.scene.add.container(),this.add(this.contentContainer),this.panel=this.scene.add.image(0,0,"white-square"),this.panel.setDisplaySize(640,640),this.panel.setAlpha(.001),this.contentContainer.add(this.panel),this.panel.setInteractive({draggable:!0}),this.panel.on("dragstart",this.handlePanelDragStart,this),this.panel.on("drag",this.handlePanelDrag,this),this.panel.on("dragend",this.handlePanelDragEnd,this),this.gameplayScene.makeResponsive(this.panel,{y:0,dy:-300}),this.productsContainer=this.scene.add.container(),this.productsContainer.y=-30,this.contentContainer.add(this.productsContainer),this.gameplayScene.makeResponsive(this.productsContainer,{y:-.1}),this.productIconIncoming=this.scene.add.image(0,0,`${this.getSelectedProductKey()}`),this.productIconIncoming.setOrigin(.5,.5),this.productsContainer.add(this.productIconIncoming),this.productIconOutgoing=this.scene.add.image(0,0,`${this.getSelectedProductKey()}`),this.productIconOutgoing.setOrigin(.5,.5),this.productsContainer.add(this.productIconOutgoing),this.tutorialText=this.scene.add.text(0,0,r.LocalizationManager.getInstance().getText(this._textKeys[this.selectedProductKeyIndex]),{fontFamily:a.GameConfig.FONTS.MAIN,fontSize:"32px",color:"#ffffff",align:"center",wordWrap:{useAdvancedWrap:!0,width:800}}),this.tutorialText.setOrigin(.5,0),this.contentContainer.add(this.tutorialText),this.gameplayScene.makeResponsive(this.tutorialText,{y:0,dy:50}),this.arrowsContainer=this.scene.add.container(),this.contentContainer.add(this.arrowsContainer),this.gameplayScene.makeResponsive(this.arrowsContainer,{y:.25}),this.arrowLeft=this.scene.add.existing(new n.BasicButton({scene:this.scene,x:-225,y:0,texture:"assets",frame:"button-continue",scale:.7,clickCallback:()=>{window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Tutorial:PreviousFrame"}),this.scrollLeft()}})),this.arrowLeft.angle=-180,this.arrowsContainer.add(this.arrowLeft),this.arrowRight=this.scene.add.existing(new n.BasicButton({scene:this.scene,x:225,y:0,texture:"assets",frame:"button-continue",scale:.7,clickCallback:()=>{window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Tutorial:NextFrame"}),this.scrollRight()}})),this.arrowRight.angle=0,this.arrowsContainer.add(this.arrowRight),this.buttonClose=this.scene.add.existing(new n.BasicButton({scene:this.scene,x:0,y:0,texture:"assets",frame:"button-close",clickCallback:()=>{window.famobi_analytics.trackEvent("EVENT_CUSTOM",{eventName:"GA:Design",eventId:"Button:Tutorial:Close"}),this.hide()}})),this.arrowsContainer.add(this.buttonClose)}resize(e,t){this.background.setDisplaySize(e,t),e/t>a.GameConfig.MAX_PORTRAIT_SCREEN_RATIO?this.contentContainer.setScale(1.5):this.contentContainer.setScale(1.45),this.tutorialText.setWordWrapWidth(.92*Math.min(1.25*a.GameConfig.getWidth(),e)/this.contentContainer.scale)}show(){this._active||(this._active=!0,this.visible=!0,this.showSelectedProduct(),this.background.alpha=0,this.scene.tweens.add({targets:this.background,alpha:1,duration:100,ease:o.default.Math.Easing.Sine.Out,onComplete:()=>{}}))}hide(){this._active&&(this._active=!1,this.visible=!1)}getSelectedProductKey(){return this._productKeys[this.selectedProductKeyIndex]}showSelectedProduct(e=0){this.scene.tweens.getTweensOf(this.productIconIncoming).forEach((e=>this.scene.tweens.remove(e)));const t=125*e;if(0==e)return this.productIconIncoming.alpha=1,this.productIconIncoming.scale=1,this.productIconOutgoing.alpha=0,void(this.productIconOutgoing.scale=1);this._prevProductKey;const s=this.getSelectedProductKey();this._prevProductKey=s,this.productIconOutgoing.destroy(),this.productIconOutgoing=this.productIconIncoming,this.productIconIncoming=this.scene.add.image(0,0,`${this.getSelectedProductKey()}`),this.productIconIncoming.setOrigin(.5,.5),this.productsContainer.add(this.productIconIncoming),this.productIconOutgoing.x=0,this.productIconOutgoing.alpha=1,this.productIconOutgoing.scale=1,this.scene.tweens.add({targets:this.productIconOutgoing,alpha:0,x:1*t,scale:.925,duration:125,ease:o.default.Math.Easing.Sine.Out,onComplete:()=>{this.productIconOutgoing.destroy()}}),this.productIconIncoming.x=-t,this.productIconIncoming.alpha=0,this.productIconIncoming.scale=.925,this.scene.tweens.add({targets:this.productIconIncoming,alpha:1,x:0,scale:1,duration:125,ease:o.default.Math.Easing.Sine.Out,onComplete:()=>{}}),this.tutorialText.setText(r.LocalizationManager.getInstance().getText(this._textKeys[this.selectedProductKeyIndex]))}handlePanelDragStart(e,t,s){this._dragReady=!0}handlePanelDragEnd(e,t,s){this._dragReady=!1}handlePanelDrag(e,t,s){this._dragReady&&(t<-100?(this._dragReady=!1,this.scrollRight()):t>100&&(this._dragReady=!1,this.scrollLeft()))}scrollLeft(){this.selectedProductKeyIndex=(this.selectedProductKeyIndex+1)%this._productKeys.length,this.showSelectedProduct(1)}scrollRight(){this.selectedProductKeyIndex-=1,this.selectedProductKeyIndex<0&&(this.selectedProductKeyIndex=this._productKeys.length-1),this.showSelectedProduct(-1)}destroy(e){this.panel.off("dragstart",this.handlePanelDragStart,this),this.panel.off("drag",this.handlePanelDrag,this),this.panel.off("dragend",this.handlePanelDragEnd,this),super.destroy(e)}}t.TutorialPopup=d},5934:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BasicButtonConfig=t.BasicButton=void 0;const i=s(4353);class a extends Phaser.GameObjects.Container{constructor(e){var t,s,n;super(e.scene,e.x||0,e.y||0),this.enabled=!0,this.isPointerDown=!1,this.isPointerOver=!1,this._baseScale=new Phaser.Math.Vector2(1,1),this.scene.add.existing(this),this.mainFrame=e.frame,this.useScaleTween=null===(t=e.applyScaleTween)||void 0===t||t,this.useTintTween=null===(s=e.applyTintTween)||void 0===s||s,this._hoverScale=e.hoverScale||a.HOVER_SCALE,this._downScale=e.downScale||a.DOWN_SCALE,this.hoverSFXKey=e.hoverSFX,this.clickSFXKey=null!==(n=e.clickSFX)&&void 0!==n?n:"click",e.scale&&this.setScale(e.scale),this.buttonBase=new Phaser.GameObjects.Image(e.scene,0,0,e.texture,e.frame),this.buttonBase.setOrigin(.5,.5),this.add(this.buttonBase),this.buttonBase.setInteractive({useHandCursor:!0}).on("pointerover",(e=>{this.scene&&this.scene.game.device.os.desktop&&(this.isPointerOver||(this.isPointerOver=!0,this.hoverSFXKey&&i.SoundManager.instance.play(this.hoverSFXKey)),this.enterButtonHoverState())})).on("pointerout",(e=>{this.isPointerOver=!1,this.enterButtonDefaultState()})).on("pointerdown",(t=>{this.enterButtonActiveState(),this.isPointerDown=!0,this.downX=t.x,this.downY=t.y,e.downCallback&&e.downCallback()})).on("pointerup",(t=>{this.enabled&&(this.enterButtonHoverState(),this.isPointerDown&&(this.triggerAction(e.clickCallback,e.upCallback),this.clickSFXKey&&i.SoundManager.instance.play(this.clickSFXKey)),this.isPointerDown=!1)}))}triggerAction(e,t){e&&e(),t&&t()}setScale(e,t){const s=super.setScale(e,t);return this._baseScale.set(this.scaleX,this.scaleY),s}setEnabled(e){this.enabled=e,this.buttonBase.alpha=this.enabled?1:.4}isEnabled(){return this.enabled}setFrame(e){this.buttonBase.setFrame(e)}preUpdate(e,t){}enterButtonHoverState(){this.enabled&&(this.useTintTween&&(this.buttonBase.tint=13421772),this.useScaleTween&&this._tweenScale(this._hoverScale))}enterButtonDefaultState(){this.enabled&&(this.useTintTween&&(this.buttonBase.tint=16777215),this.useScaleTween&&this._tweenScale(1))}enterButtonActiveState(){this.enabled&&(this.useTintTween&&(this.buttonBase.tint=11184810),this.useScaleTween&&this._tweenScale(this._downScale))}_tweenScale(e){this.scaleTween&&this.scene.tweens.remove(this.scaleTween),this.scaleTween=this.scene.tweens.add({targets:this,scaleX:this._baseScale.x*e,scaleY:this._baseScale.y*e,duration:75})}}a.HOVER_SCALE=1.0125,a.DOWN_SCALE=.975,t.BasicButton=a;t.BasicButtonConfig=class{constructor(){this.x=0,this.y=0}}},8116:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RewardedButtonConfig=t.RewardedButton=void 0;const a=s(9898),n=s(5934),o=i(s(2260)),r=s(3786);class d extends n.BasicButton{constructor(e){var t,s,i,n,r,d,h,c;super(e),this.rewardedFrame=null!==(t=e.rewardedFrame)&&void 0!==t?t:e.frame,this.rewardedPeriod=e.rewardedPeriod,this.rewardedCallback=e.rewardedCallback,this.dataKey=e.dataKey,this.textStyle=e.textStyle,this.wrapText=null===(s=e.wrapText)||void 0===s||s,this.scaleTextToFit=null!==(i=e.scaleTextToFit)&&void 0!==i&&i,this.textZoneMaxWidth=null!==(n=e.textZoneMaxWidth)&&void 0!==n?n:.925,this.hideButtonBase=null!==(r=e.hideButtonBase)&&void 0!==r&&r,this.textPosition=null!==(d=e.textPosition)&&void 0!==d?d:{x:0,y:0},this.textMargin=null!==(h=e.textMargin)&&void 0!==h?h:{x:5,y:5},this.lazyAction=null!==(c=e.lazyAction)&&void 0!==c&&c;const l={fontFamily:a.GameConfig.FONTS.MAIN,fontSize:36,color:"#ffffff"};this.wrapText&&Object.assign(l,{wordWrap:{useAdvancedWrap:!0,width:this.buttonBase.displayWidth*this.textZoneMaxWidth}}),Object.assign(l,this.textStyle),this.textField=new o.default.GameObjects.Text(e.scene,this.textPosition.x,this.textPosition.y,this.text,l),this.textField.setOrigin(.5,.5),this.add(this.textField),this.scaleTextToFit&&this.textField.setScale(Math.max(Math.min(this.buttonBase.displayWidth/this.textField.displayWidth*this.textZoneMaxWidth,1),.25)),this.hideButtonBase&&(this.buttonBase.setAlpha(.001),this.buttonBase.setDisplaySize(this.textField.displayWidth+2*this.textMargin.x,this.textField.displayHeight+2*this.textMargin.y)),this.updateView()}preUpdate(e,t){super.preUpdate(e,t),this.textField.setText(this.enabled?`${this.rewardedCountdown}`:"")}triggerAction(e,t){this.rewardedCountdown<1?(this.rewardedCountdown=0,this.setEnabled(!1),this.rewardedCallback().then((s=>{s&&(e&&e(),t&&t(),this.rewardedCountdown=this.rewardedPeriod,this.updateView()),(0,r.rewardedVideosEnabled)()&&this.setEnabled(!0)}))):(e&&e(),t&&t()),this.lazyAction||(this.rewardedCountdown-=1),this.setEnabled(this.enabled),this.updateView()}registerLazyAttempt(){this.rewardedCountdown-=1,this.setEnabled(this.enabled),this.updateView()}updateView(){(0,r.rewardedVideosEnabled)()?a.GameConfig.USE_REWARDED_VIDEOS_ONLY?this.rewardedCountdown>0?(this.buttonBase.setFrame(this.mainFrame),this.textField.setVisible(!0),this.textField.setText(this.enabled?`${this.rewardedCountdown}`:"")):famobi.hasRewardedAd()?(this.buttonBase.setFrame(this.rewardedFrame),this.textField.setVisible(!1)):(this.buttonBase.setFrame(this.mainFrame),this.textField.setVisible(!1)):this.rewardedCountdown>0?(this.buttonBase.setFrame(this.mainFrame),this.textField.setVisible(!0),this.textField.setText(this.enabled?`${this.rewardedCountdown}`:"")):(this.buttonBase.setFrame(this.rewardedFrame),this.textField.setVisible(!1)):(this.buttonBase.setFrame(this.mainFrame),this.rewardedCountdown>0?(this.textField.setVisible(!0),this.textField.setText(this.enabled?`${this.rewardedCountdown}`:"")):(this.textField.setVisible(!1),this.textField.setText("")))}blinkRed(){this.scene.tweens.addCounter({from:255,to:127,duration:75,yoyo:!0,repeat:3,onUpdate:e=>{const t=Math.floor(e.getValue());this.buttonBase.setTint(o.default.Display.Color.GetColor(255,t,t)),this.textField.setTint(o.default.Display.Color.GetColor(255,t,t))}})}setEnabled(e){(0,r.rewardedVideosEnabled)()?this.enabled=e&&(this.rewardedCountdown>0||famobi.hasRewardedAd()):this.enabled=e&&this.rewardedCountdown>0,this.updateView(),e&&this.enterButtonDefaultState(),this.hideButtonBase?this.textField.alpha=this.enabled?1:.4:(this.buttonBase.alpha=this.enabled?1:.4,this.textField.alpha=this.buttonBase.alpha)}enterButtonHoverState(){super.enterButtonHoverState(),this.enabled&&(this.textField.tint=13421772)}enterButtonDefaultState(){super.enterButtonDefaultState(),this.enabled&&(this.textField.tint=16777215)}enterButtonActiveState(){super.enterButtonActiveState(),this.enabled&&(this.textField.tint=11184810)}get rewardedCountdown(){return a.GameConfig.REWARDED_BUTTON_COOLODOWNS[this.dataKey]}set rewardedCountdown(e){a.GameConfig.REWARDED_BUTTON_COOLODOWNS[this.dataKey]=e}}t.RewardedButton=d;class h extends n.BasicButtonConfig{constructor(){super(...arguments),this.wrapText=!0,this.scaleTextToFit=!1}}t.RewardedButtonConfig=h},272:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const i=s(9898);class a{static setLoadingSpinnerVisible(e){document.querySelector("#preloader").style.display=e?"block":"none"}static setLoadingSpinnerProgress(e){i.GameConfig.SHOW_LOADING_PROGRESS&&e>0&&(document.querySelector("#loading-text").textContent=Math.floor(100*e)+"%")}static postMessage(e){window.parent.postMessage(e,"*")}}a.humanizeTime=function(e){if(null==e)return"--:--";let t=e,s=Math.floor(t/3600);t%=3600;let i=Math.floor(t/60);return t%=60,(s<10?"0":"")+s+":"+(i<10?"0":"")+i+":"+(t<10?"0":"")+Math.floor(t)},a.humanizeTimeShort=function(e){let t=e;Math.floor(t/3600);t%=3600;let s=Math.floor(t/60);return t%=60,(s<10?"0":"")+s+":"+(t<10?"0":"")+Math.floor(t)},t.Utils=a}},s={};function i(e){var a=s[e];if(void 0!==a)return a.exports;var n=s[e]={exports:{}};return t[e].call(n.exports,n,n.exports,i),n.exports}i.m=t,e=[],i.O=(t,s,a,n)=>{if(!s){var o=1/0;for(c=0;c<e.length;c++){for(var[s,a,n]=e[c],r=!0,d=0;d<s.length;d++)(!1&n||o>=n)&&Object.keys(i.O).every((e=>i.O[e](s[d])))?s.splice(d--,1):(r=!1,n<o&&(o=n));if(r){e.splice(c--,1);var h=a();void 0!==h&&(t=h)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,a,n]},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var a,n,[o,r,d]=s,h=0;if(o.some((t=>0!==e[t]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(d)var c=d(i)}for(t&&t(s);h<o.length;h++)n=o[h],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(c)},s=self.webpackChunkhtml5_minigame=self.webpackChunkhtml5_minigame||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var a=i.O(void 0,[216],(()=>i(8537)));a=i.O(a)})();